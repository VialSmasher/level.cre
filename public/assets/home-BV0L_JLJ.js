import{j as e,u as jt,t as wt,H as Ct,a as St,E as kt,m as Nt,z as _t,w as Et,b as Pt,L as Ot,G as Tt,D as It,M as it,P as Rt,I as Dt}from"./maps-BkP_85Bm.js";import{e as At,c as Ft,r as l}from"./react-BUvn9Qyq.js";import{c as Lt,B as le,X as Ke,T as Mt,a as Ge,b as Qe,S as ot,d as Ye,e as Ne,u as zt,f as $t,q as Ie}from"./index-DIhazG7A.js";import{L as K,I as Ae}from"./label-1jjjNnWq.js";import{T as qt}from"./textarea-D0vZhPYN.js";import{S as xe,a as ye,b as ve,c as _e,d as te}from"./select-DtWl5TGT.js";import{S as Je,M as Ut,T as Wt,a as Bt,b as lt,c as ct,d as dt,P as ut,e as Vt}from"./StatusLegend-BMpzq6H0.js";import{D as ht,a as pt,b as ft,c as mt,d as gt}from"./dialog-BERENffF.js";import{A as tt,a as st}from"./alert-ClfNS6l5.js";import{U as Ht,r as Oe,n as ce,w as $e}from"./storage-BrJqrBtb.js";import{C as rt}from"./circle-alert-Da-H2gXT.js";import{A as Kt}from"./arrow-right-B-2AVouG.js";import{u as Gt}from"./useProfile-DmUgQoUG.js";import{u as Qt}from"./submarkets-DYRPNR7X.js";import{u as Yt}from"./query-BAwt2wOP.js";import{T as Zt}from"./trash-2-Cz6C_y_-.js";import"./supabase-LVwxr6rx.js";import"./charts-Ciu5p52_.js";import"./index-NSkCLJ8O.js";import"./map-pin-C6sM-pao.js";const Jt=Lt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var xt={exports:{}};(function(D,se){((Y,p)=>{D.exports=p()})(Ft,function Y(){var p=typeof self<"u"?self:typeof window<"u"?window:p!==void 0?p:{},Z,G=!p.document&&!!p.postMessage,H=p.IS_PAPA_WORKER||!1,R={},be=0,y={};function re(r){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(t){var n=Te(t);n.chunkSize=parseInt(n.chunkSize),t.step||t.chunk||(n.chunkSize=null),this._handle=new we(n),(this._handle.streamer=this)._config=n}.call(this,r),this.parseChunk=function(t,n){var i=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<i){let v=this._config.newline;v||(o=this._config.quoteChar||'"',v=this._handle.guessLineEndings(t,o)),t=[...t.split(v).slice(i)].join(v)}this.isFirstChunk&&F(this._config.beforeFirstChunk)&&(o=this._config.beforeFirstChunk(t))!==void 0&&(t=o),this.isFirstChunk=!1,this._halted=!1;var i=this._partialLine+t,o=(this._partialLine="",this._handle.parse(i,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=o.meta.cursor,i=(this._finished||(this._partialLine=i.substring(t-this._baseIndex),this._baseIndex=t),o&&o.data&&(this._rowCount+=o.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),H)p.postMessage({results:o,workerId:y.WORKER_ID,finished:i});else if(F(this._config.chunk)&&!n){if(this._config.chunk(o,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=o=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(o.data),this._completeResults.errors=this._completeResults.errors.concat(o.errors),this._completeResults.meta=o.meta),this._completed||!i||!F(this._config.complete)||o&&o.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),i||o&&o.meta.paused||this._nextChunk(),o}this._halted=!0},this._sendError=function(t){F(this._config.error)?this._config.error(t):H&&this._config.error&&p.postMessage({workerId:y.WORKER_ID,error:t,finished:!1})}}function je(r){var t;(r=r||{}).chunkSize||(r.chunkSize=y.RemoteChunkSize),re.call(this,r),this._nextChunk=G?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(n){this._input=n,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),G||(t.onload=de(this._chunkLoaded,this),t.onerror=de(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!G),this._config.downloadRequestHeaders){var n,i=this._config.downloadRequestHeaders;for(n in i)t.setRequestHeader(n,i[n])}var o;this._config.chunkSize&&(o=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+o));try{t.send(this._config.downloadRequestBody)}catch(v){this._chunkError(v.message)}G&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(n=>(n=n.getResponseHeader("Content-Range"))!==null?parseInt(n.substring(n.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(n){n=t.statusText||n,this._sendError(new Error(n))}}function he(r){(r=r||{}).chunkSize||(r.chunkSize=y.LocalChunkSize),re.call(this,r);var t,n,i=typeof FileReader<"u";this.stream=function(o){this._input=o,n=o.slice||o.webkitSlice||o.mozSlice,i?((t=new FileReader).onload=de(this._chunkLoaded,this),t.onerror=de(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var o=this._input,v=(this._config.chunkSize&&(v=Math.min(this._start+this._config.chunkSize,this._input.size),o=n.call(o,this._start,v)),t.readAsText(o,this._config.encoding));i||this._chunkLoaded({target:{result:v}})},this._chunkLoaded=function(o){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(o.target.result)},this._chunkError=function(){this._sendError(t.error)}}function M(r){var t;re.call(this,r=r||{}),this.stream=function(n){return t=n,this._nextChunk()},this._nextChunk=function(){var n,i;if(!this._finished)return n=this._config.chunkSize,t=n?(i=t.substring(0,n),t.substring(n)):(i=t,""),this._finished=!t,this.parseChunk(i)}}function ee(r){re.call(this,r=r||{});var t=[],n=!0,i=!1;this.pause=function(){re.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){re.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(o){this._input=o,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){i&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):n=!0},this._streamData=de(function(o){try{t.push(typeof o=="string"?o:o.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(v){this._streamError(v)}},this),this._streamError=de(function(o){this._streamCleanUp(),this._sendError(o)},this),this._streamEnd=de(function(){this._streamCleanUp(),i=!0,this._streamData("")},this),this._streamCleanUp=de(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function we(r){var t,n,i,o,v=Math.pow(2,53),P=-v,U=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,B=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,x=this,k=0,g=0,O=!1,b=!1,a=[],d={data:[],errors:[],meta:{}};function V(E){return r.skipEmptyLines==="greedy"?E.join("").trim()==="":E.length===1&&E[0].length===0}function z(){if(d&&i&&(ae("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+y.DefaultDelimiter+"'"),i=!1),r.skipEmptyLines&&(d.data=d.data.filter(function(j){return!V(j)})),L()){let j=function(W,I){F(r.transformHeader)&&(W=r.transformHeader(W,I)),a.push(W)};if(d)if(Array.isArray(d.data[0])){for(var E=0;L()&&E<d.data.length;E++)d.data[E].forEach(j);d.data.splice(0,1)}else d.data.forEach(j)}function T(j,W){for(var I=r.header?{}:[],A=0;A<j.length;A++){var N=A,w=j[A],w=((ie,C)=>(q=>(r.dynamicTypingFunction&&r.dynamicTyping[q]===void 0&&(r.dynamicTyping[q]=r.dynamicTypingFunction(q)),(r.dynamicTyping[q]||r.dynamicTyping)===!0))(ie)?C==="true"||C==="TRUE"||C!=="false"&&C!=="FALSE"&&((q=>{if(U.test(q)&&(q=parseFloat(q),P<q&&q<v))return 1})(C)?parseFloat(C):B.test(C)?new Date(C):C===""?null:C):C)(N=r.header?A>=a.length?"__parsed_extra":a[A]:N,w=r.transform?r.transform(w,N):w);N==="__parsed_extra"?(I[N]=I[N]||[],I[N].push(w)):I[N]=w}return r.header&&(A>a.length?ae("FieldMismatch","TooManyFields","Too many fields: expected "+a.length+" fields but parsed "+A,g+W):A<a.length&&ae("FieldMismatch","TooFewFields","Too few fields: expected "+a.length+" fields but parsed "+A,g+W)),I}var $;d&&(r.header||r.dynamicTyping||r.transform)&&($=1,!d.data.length||Array.isArray(d.data[0])?(d.data=d.data.map(T),$=d.data.length):d.data=T(d.data,0),r.header&&d.meta&&(d.meta.fields=a),g+=$)}function L(){return r.header&&a.length===0}function ae(E,T,$,j){E={type:E,code:T,message:$},j!==void 0&&(E.row=j),d.errors.push(E)}F(r.step)&&(o=r.step,r.step=function(E){d=E,L()?z():(z(),d.data.length!==0&&(k+=E.data.length,r.preview&&k>r.preview?n.abort():(d.data=d.data[0],o(d,x))))}),this.parse=function(E,T,$){var j=r.quoteChar||'"',j=(r.newline||(r.newline=this.guessLineEndings(E,j)),i=!1,r.delimiter?F(r.delimiter)&&(r.delimiter=r.delimiter(E),d.meta.delimiter=r.delimiter):((j=((W,I,A,N,w)=>{var ie,C,q,Ce;w=w||[",","	","|",";",y.RECORD_SEP,y.UNIT_SEP];for(var Fe=0;Fe<w.length;Fe++){for(var ue,Le=w[Fe],J=0,pe=0,Q=0,oe=(q=void 0,new ne({comments:N,delimiter:Le,newline:I,preview:10}).parse(W)),fe=0;fe<oe.data.length;fe++)A&&V(oe.data[fe])?Q++:(ue=oe.data[fe].length,pe+=ue,q===void 0?q=ue:0<ue&&(J+=Math.abs(ue-q),q=ue));0<oe.data.length&&(pe/=oe.data.length-Q),(C===void 0||J<=C)&&(Ce===void 0||Ce<pe)&&1.99<pe&&(C=J,ie=Le,Ce=pe)}return{successful:!!(r.delimiter=ie),bestDelimiter:ie}})(E,r.newline,r.skipEmptyLines,r.comments,r.delimitersToGuess)).successful?r.delimiter=j.bestDelimiter:(i=!0,r.delimiter=y.DefaultDelimiter),d.meta.delimiter=r.delimiter),Te(r));return r.preview&&r.header&&j.preview++,t=E,n=new ne(j),d=n.parse(t,T,$),z(),O?{meta:{paused:!0}}:d||{meta:{paused:!1}}},this.paused=function(){return O},this.pause=function(){O=!0,n.abort(),t=F(r.chunk)?"":t.substring(n.getCharIndex())},this.resume=function(){x.streamer._halted?(O=!1,x.streamer.parseChunk(t,!0)):setTimeout(x.resume,3)},this.aborted=function(){return b},this.abort=function(){b=!0,n.abort(),d.meta.aborted=!0,F(r.complete)&&r.complete(d),t=""},this.guessLineEndings=function(W,j){W=W.substring(0,1048576);var j=new RegExp(Ee(j)+"([^]*?)"+Ee(j),"gm"),$=(W=W.replace(j,"")).split("\r"),j=W.split(`
`),W=1<j.length&&j[0].length<$[0].length;if($.length===1||W)return`
`;for(var I=0,A=0;A<$.length;A++)$[A][0]===`
`&&I++;return I>=$.length/2?`\r
`:"\r"}}function Ee(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ne(r){var t=(r=r||{}).delimiter,n=r.newline,i=r.comments,o=r.step,v=r.preview,P=r.fastMode,U=null,B=!1,x=r.quoteChar==null?'"':r.quoteChar,k=x;if(r.escapeChar!==void 0&&(k=r.escapeChar),(typeof t!="string"||-1<y.BAD_DELIMITERS.indexOf(t))&&(t=","),i===t)throw new Error("Comment character same as delimiter");i===!0?i="#":(typeof i!="string"||-1<y.BAD_DELIMITERS.indexOf(i))&&(i=!1),n!==`
`&&n!=="\r"&&n!==`\r
`&&(n=`
`);var g=0,O=!1;this.parse=function(b,a,d){if(typeof b!="string")throw new Error("Input must be a string");var V=b.length,z=t.length,L=n.length,ae=i.length,E=F(o),T=[],$=[],j=[],W=g=0;if(!b)return J();if(P||P!==!1&&b.indexOf(x)===-1){for(var I=b.split(n),A=0;A<I.length;A++){if(j=I[A],g+=j.length,A!==I.length-1)g+=n.length;else if(d)return J();if(!i||j.substring(0,ae)!==i){if(E){if(T=[],Ce(j.split(t)),pe(),O)return J()}else Ce(j.split(t));if(v&&v<=A)return T=T.slice(0,v),J(!0)}}return J()}for(var N=b.indexOf(t,g),w=b.indexOf(n,g),ie=new RegExp(Ee(k)+Ee(x),"g"),C=b.indexOf(x,g);;)if(b[g]===x)for(C=g,g++;;){if((C=b.indexOf(x,C+1))===-1)return d||$.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:T.length,index:g}),ue();if(C===V-1)return ue(b.substring(g,C).replace(ie,x));if(x===k&&b[C+1]===k)C++;else if(x===k||C===0||b[C-1]!==k){N!==-1&&N<C+1&&(N=b.indexOf(t,C+1));var q=Fe((w=w!==-1&&w<C+1?b.indexOf(n,C+1):w)===-1?N:Math.min(N,w));if(b.substr(C+1+q,z)===t){j.push(b.substring(g,C).replace(ie,x)),b[g=C+1+q+z]!==x&&(C=b.indexOf(x,g)),N=b.indexOf(t,g),w=b.indexOf(n,g);break}if(q=Fe(w),b.substring(C+1+q,C+1+q+L)===n){if(j.push(b.substring(g,C).replace(ie,x)),Le(C+1+q+L),N=b.indexOf(t,g),C=b.indexOf(x,g),E&&(pe(),O))return J();if(v&&T.length>=v)return J(!0);break}$.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:T.length,index:g}),C++}}else if(i&&j.length===0&&b.substring(g,g+ae)===i){if(w===-1)return J();g=w+L,w=b.indexOf(n,g),N=b.indexOf(t,g)}else if(N!==-1&&(N<w||w===-1))j.push(b.substring(g,N)),g=N+z,N=b.indexOf(t,g);else{if(w===-1)break;if(j.push(b.substring(g,w)),Le(w+L),E&&(pe(),O))return J();if(v&&T.length>=v)return J(!0)}return ue();function Ce(Q){T.push(Q),W=g}function Fe(Q){var oe=0;return oe=Q!==-1&&(Q=b.substring(C+1,Q))&&Q.trim()===""?Q.length:oe}function ue(Q){return d||(Q===void 0&&(Q=b.substring(g)),j.push(Q),g=V,Ce(j),E&&pe()),J()}function Le(Q){g=Q,Ce(j),j=[],w=b.indexOf(n,g)}function J(Q){if(r.header&&!a&&T.length&&!B){var oe=T[0],fe=Object.create(null),Be=new Set(oe);let Ve=!1;for(let De=0;De<oe.length;De++){let me=oe[De];if(fe[me=F(r.transformHeader)?r.transformHeader(me,De):me]){let Pe,Ze=fe[me];for(;Pe=me+"_"+Ze,Ze++,Be.has(Pe););Be.add(Pe),oe[De]=Pe,fe[me]++,Ve=!0,(U=U===null?{}:U)[Pe]=me}else fe[me]=1,oe[De]=me;Be.add(me)}B=!0}return{data:T,errors:$,meta:{delimiter:t,linebreak:n,aborted:O,truncated:!!Q,cursor:W+(a||0),renamedHeaders:U}}}function pe(){o(J()),T=[],$=[]}},this.abort=function(){O=!0},this.getCharIndex=function(){return g}}function qe(r){var t=r.data,n=R[t.workerId],i=!1;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var o={abort:function(){i=!0,Re(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Ue,resume:Ue};if(F(n.userStep)){for(var v=0;v<t.results.data.length&&(n.userStep({data:t.results.data[v],errors:t.results.errors,meta:t.results.meta},o),!i);v++);delete t.results}else F(n.userChunk)&&(n.userChunk(t.results,o,t.file),delete t.results)}t.finished&&!i&&Re(t.workerId,t.results)}function Re(r,t){var n=R[r];F(n.userComplete)&&n.userComplete(t),n.terminate(),delete R[r]}function Ue(){throw new Error("Not implemented.")}function Te(r){if(typeof r!="object"||r===null)return r;var t,n=Array.isArray(r)?[]:{};for(t in r)n[t]=Te(r[t]);return n}function de(r,t){return function(){r.apply(t,arguments)}}function F(r){return typeof r=="function"}return y.parse=function(r,t){var n=(t=t||{}).dynamicTyping||!1;if(F(n)&&(t.dynamicTypingFunction=n,n={}),t.dynamicTyping=n,t.transform=!!F(t.transform)&&t.transform,!t.worker||!y.WORKERS_SUPPORTED)return n=null,y.NODE_STREAM_INPUT,typeof r=="string"?(r=(i=>i.charCodeAt(0)!==65279?i:i.slice(1))(r),n=new(t.download?je:M)(t)):r.readable===!0&&F(r.read)&&F(r.on)?n=new ee(t):(p.File&&r instanceof File||r instanceof Object)&&(n=new he(t)),n.stream(r);(n=(()=>{var i;return!!y.WORKERS_SUPPORTED&&(i=(()=>{var o=p.URL||p.webkitURL||null,v=Y.toString();return y.BLOB_URL||(y.BLOB_URL=o.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",v,")();"],{type:"text/javascript"})))})(),(i=new p.Worker(i)).onmessage=qe,i.id=be++,R[i.id]=i)})()).userStep=t.step,n.userChunk=t.chunk,n.userComplete=t.complete,n.userError=t.error,t.step=F(t.step),t.chunk=F(t.chunk),t.complete=F(t.complete),t.error=F(t.error),delete t.worker,n.postMessage({input:r,config:t,workerId:n.id})},y.unparse=function(r,t){var n=!1,i=!0,o=",",v=`\r
`,P='"',U=P+P,B=!1,x=null,k=!1,g=((()=>{if(typeof t=="object"){if(typeof t.delimiter!="string"||y.BAD_DELIMITERS.filter(function(a){return t.delimiter.indexOf(a)!==-1}).length||(o=t.delimiter),typeof t.quotes!="boolean"&&typeof t.quotes!="function"&&!Array.isArray(t.quotes)||(n=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(B=t.skipEmptyLines),typeof t.newline=="string"&&(v=t.newline),typeof t.quoteChar=="string"&&(P=t.quoteChar),typeof t.header=="boolean"&&(i=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");x=t.columns}t.escapeChar!==void 0&&(U=t.escapeChar+P),t.escapeFormulae instanceof RegExp?k=t.escapeFormulae:typeof t.escapeFormulae=="boolean"&&t.escapeFormulae&&(k=/^[=+\-@\t\r].*$/)}})(),new RegExp(Ee(P),"g"));if(typeof r=="string"&&(r=JSON.parse(r)),Array.isArray(r)){if(!r.length||Array.isArray(r[0]))return O(null,r,B);if(typeof r[0]=="object")return O(x||Object.keys(r[0]),r,B)}else if(typeof r=="object")return typeof r.data=="string"&&(r.data=JSON.parse(r.data)),Array.isArray(r.data)&&(r.fields||(r.fields=r.meta&&r.meta.fields||x),r.fields||(r.fields=Array.isArray(r.data[0])?r.fields:typeof r.data[0]=="object"?Object.keys(r.data[0]):[]),Array.isArray(r.data[0])||typeof r.data[0]=="object"||(r.data=[r.data])),O(r.fields||[],r.data||[],B);throw new Error("Unable to serialize unrecognized input");function O(a,d,V){var z="",L=(typeof a=="string"&&(a=JSON.parse(a)),typeof d=="string"&&(d=JSON.parse(d)),Array.isArray(a)&&0<a.length),ae=!Array.isArray(d[0]);if(L&&i){for(var E=0;E<a.length;E++)0<E&&(z+=o),z+=b(a[E],E);0<d.length&&(z+=v)}for(var T=0;T<d.length;T++){var $=(L?a:d[T]).length,j=!1,W=L?Object.keys(d[T]).length===0:d[T].length===0;if(V&&!L&&(j=V==="greedy"?d[T].join("").trim()==="":d[T].length===1&&d[T][0].length===0),V==="greedy"&&L){for(var I=[],A=0;A<$;A++){var N=ae?a[A]:A;I.push(d[T][N])}j=I.join("").trim()===""}if(!j){for(var w=0;w<$;w++){0<w&&!W&&(z+=o);var ie=L&&ae?a[w]:w;z+=b(d[T][ie],w)}T<d.length-1&&(!V||0<$&&!W)&&(z+=v)}}return z}function b(a,d){var V,z;return a==null?"":a.constructor===Date?JSON.stringify(a).slice(1,25):(z=!1,k&&typeof a=="string"&&k.test(a)&&(a="'"+a,z=!0),V=a.toString().replace(g,U),(z=z||n===!0||typeof n=="function"&&n(a,d)||Array.isArray(n)&&n[d]||((L,ae)=>{for(var E=0;E<ae.length;E++)if(-1<L.indexOf(ae[E]))return!0;return!1})(V,y.BAD_DELIMITERS)||-1<V.indexOf(o)||V.charAt(0)===" "||V.charAt(V.length-1)===" ")?P+V+P:V)}},y.RECORD_SEP="",y.UNIT_SEP="",y.BYTE_ORDER_MARK="\uFEFF",y.BAD_DELIMITERS=["\r",`
`,'"',y.BYTE_ORDER_MARK],y.WORKERS_SUPPORTED=!G&&!!p.Worker,y.NODE_STREAM_INPUT=1,y.LocalChunkSize=10485760,y.RemoteChunkSize=5242880,y.DefaultDelimiter=",",y.Parser=ne,y.ParserHandle=we,y.NetworkStreamer=je,y.FileStreamer=he,y.StringStreamer=M,y.ReadableStreamStreamer=ee,p.jQuery&&((Z=p.jQuery).fn.parse=function(r){var t=r.config||{},n=[];return this.each(function(v){if(!(Z(this).prop("tagName").toUpperCase()==="INPUT"&&Z(this).attr("type").toLowerCase()==="file"&&p.FileReader)||!this.files||this.files.length===0)return!0;for(var P=0;P<this.files.length;P++)n.push({file:this.files[P],inputElem:this,instanceConfig:Z.extend({},t)})}),i(),this;function i(){if(n.length===0)F(r.complete)&&r.complete();else{var v,P,U,B,x=n[0];if(F(r.before)){var k=r.before(x.file,x.inputElem);if(typeof k=="object"){if(k.action==="abort")return v="AbortError",P=x.file,U=x.inputElem,B=k.reason,void(F(r.error)&&r.error({name:v},P,U,B));if(k.action==="skip")return void o();typeof k.config=="object"&&(x.instanceConfig=Z.extend(x.instanceConfig,k.config))}else if(k==="skip")return void o()}var g=x.instanceConfig.complete;x.instanceConfig.complete=function(O){F(g)&&g(O,x.file,x.inputElem),o()},y.parse(x.file,x.instanceConfig)}}function o(){n.splice(0,1),i()}}),H&&(p.onmessage=function(r){r=r.data,y.WORKER_ID===void 0&&r&&(y.WORKER_ID=r.workerId),typeof r.input=="string"?p.postMessage({workerId:y.WORKER_ID,results:y.parse(r.input,r.config),finished:!0}):(p.File&&r.input instanceof File||r.input instanceof Object)&&(r=y.parse(r.input,r.config))&&p.postMessage({workerId:y.WORKER_ID,results:r,finished:!0})}),(je.prototype=Object.create(re.prototype)).constructor=je,(he.prototype=Object.create(re.prototype)).constructor=he,(M.prototype=Object.create(M.prototype)).constructor=M,(ee.prototype=Object.create(re.prototype)).constructor=ee,y})})(xt);var Xt=xt.exports;const es=At(Xt);function ts({onProspectsImport:D}){const[se,Y]=l.useState(!1),[p,Z]=l.useState(null),[G,H]=l.useState(""),[R,be]=l.useState(!1),[y,re]=l.useState(!1),[je,he]=l.useState([]),[M,ee]=l.useState({name:"",coordinates:"",latitude:"",longitude:"",notes:"",submarketId:""}),[we,Ee]=l.useState("single"),ne=l.useRef(null),qe=t=>{const n=t.target.files?.[0];n&&n.type==="text/csv"?(Z(n),H("")):(H("Please select a valid CSV file"),Z(null))},Re=t=>{const n=es.parse(t,{header:!0,skipEmptyLines:!0,transformHeader:o=>o.trim().toLowerCase(),quoteChar:'"',escapeChar:'"',delimiter:","});return n.errors.length>0,n.data.filter(o=>o&&Object.keys(o).some(v=>o[v]&&o[v].trim()))},Ue=async()=>{if(p){be(!0),H("");try{const t=await p.text(),n=Re(t);if(n.length===0){H("No valid data found in CSV file");return}he(n),re(!0)}catch(t){H(t instanceof Error?t.message:"Failed to process CSV file")}finally{be(!1)}}},Te=()=>{const n=(we==="single"?["name","coordinates"]:["name","latitude","longitude"]).filter(i=>!M[i]);if(n.length>0){H(`Please map the required columns: ${n.join(", ")}`);return}try{const i=je.map((o,v)=>{let P,U;if(we==="single"){const x=o[M.coordinates]||"";if(x.includes("POLYGON"))P=0,U=0;else if(x.includes("POINT")){const k=x.replace(/^"(.*)"$/,"$1"),g=k.match(/POINT\s*\(\s*([^\s]+)\s+([^\s)]+)\s*\)/i);if(g)U=parseFloat(g[1]),P=parseFloat(g[2]);else throw new Error(`Invalid POINT format in row ${v+2}: "${k}". Expected: "POINT(lng lat)"`)}else if(x.includes(",")){const k=x.split(",").map(g=>parseFloat(g.trim()));if(k.length!==2||k.some(isNaN))throw new Error(`Invalid coordinates in row ${v+2}: "${x}". Expected format: "lat,lng"`);[P,U]=k}else{const k=x.trim().split(/\s+/).map(g=>parseFloat(g));if(k.length!==2||k.some(isNaN))throw new Error(`Invalid coordinates in row ${v+2}: "${x}". Expected format: "lat lng" or "lat,lng" or "POINT(lng lat)"`);[P,U]=k}if((isNaN(P)||isNaN(U))&&!x.includes("POLYGON"))throw new Error(`Invalid coordinates in row ${v+2}: "${x}"`)}else if(P=parseFloat(o[M.latitude]||"0"),U=parseFloat(o[M.longitude]||"0"),isNaN(P)||isNaN(U))throw new Error(`Invalid coordinates in row ${v+2}. lat=${P}, lng=${U}`);let B;if(we==="single"){const x=o[M.coordinates]||"";if(x.includes("POLYGON")){const k=x.replace(/^"(.*)"$/,"$1"),g=k.match(/POLYGON\s*\(\s*\(\s*([^)]+)\s*\)\s*\)/i);if(g)try{const O=g[1].split(",").map(b=>{const a=b.trim().split(/\s+/);if(a.length!==2)throw new Error(`Invalid coordinate pair: "${b.trim()}"`);const d=parseFloat(a[0]),V=parseFloat(a[1]);if(isNaN(d)||isNaN(V))throw new Error(`Invalid numbers in coordinate pair: "${b.trim()}"`);return[d,V]});O.length>0&&(O[0][0]!==O[O.length-1][0]||O[0][1]!==O[O.length-1][1])&&O.push(O[0]),B={type:"Polygon",coordinates:[O]}}catch(O){const b=O instanceof Error?O.message:String(O);throw new Error(`Invalid POLYGON coordinates in row ${v+2}: ${b}. Expected format: "POLYGON ((lng lat, lng lat, ...))"`)}else throw new Error(`Invalid POLYGON format in row ${v+2}: "${k}". Expected format: "POLYGON ((lng lat, lng lat, ...))"`)}else B={type:"Point",coordinates:[U,P]}}else B={type:"Point",coordinates:[U,P]};return{id:`csv-${Date.now()}-${v}`,name:o[M.name]||`Imported Prospect ${v+1}`,status:"prospect",notes:M.notes&&M.notes!=="none"&&o[M.notes]||"",submarketId:M.submarketId&&M.submarketId!=="none"&&o[M.submarketId]||void 0,lastContactDate:void 0,createdDate:new Date().toISOString(),geometry:B}});D(i),Y(!1),de()}catch(i){H(i instanceof Error?i.message:"Failed to import prospects")}},de=()=>{Z(null),re(!1),he([]),ee({name:"",coordinates:"",latitude:"",longitude:"",notes:"",submarketId:""}),Ee("single"),H("")},F=()=>{de(),ne.current&&(ne.current.value="")},r=()=>je.length===0?[]:Object.keys(je[0]);return e.jsxs(ht,{open:se,onOpenChange:Y,children:[e.jsx(pt,{asChild:!0,children:e.jsxs("div",{className:"flex items-center w-full p-0 h-auto",children:[e.jsx(Ht,{className:"mr-2 h-4 w-4"}),"Import CSV"]})}),e.jsxs(ft,{className:"sm:max-w-lg",children:[e.jsx(mt,{children:e.jsxs(gt,{className:"flex items-center gap-2",children:[e.jsx(Jt,{className:"h-5 w-5"}),y?"Map CSV Columns":"Import Prospects from CSV"]})}),y?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-3 bg-blue-50 rounded-md",children:e.jsx("p",{className:"text-sm text-blue-800",children:"Map your CSV columns to prospect fields. Choose your coordinate format first."})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(K,{className:"text-sm font-medium",children:"Coordinate Format"}),e.jsxs(xe,{value:we,onValueChange:t=>Ee(t),children:[e.jsx(ye,{children:e.jsx(ve,{})}),e.jsxs(_e,{children:[e.jsx(te,{value:"single",children:"Single Column (lat,lng or POINT format)"}),e.jsx(te,{value:"separate",children:"Separate Columns (lat/lng)"})]})]})]}),e.jsxs("div",{children:[e.jsx(K,{className:"text-sm font-medium text-red-600",children:"Name * (Required)"}),e.jsxs(xe,{value:M.name,onValueChange:t=>ee(n=>({...n,name:t})),children:[e.jsx(ye,{children:e.jsx(ve,{placeholder:"Select name column"})}),e.jsx(_e,{children:r().map(t=>e.jsx(te,{value:t,children:t},t))})]})]}),we==="single"?e.jsxs("div",{children:[e.jsx(K,{className:"text-sm font-medium text-red-600",children:"Coordinates * (Required)"}),e.jsxs(xe,{value:M.coordinates,onValueChange:t=>ee(n=>({...n,coordinates:t})),children:[e.jsx(ye,{children:e.jsx(ve,{placeholder:"Select WKT/coordinates column"})}),e.jsx(_e,{children:r().map(t=>e.jsx(te,{value:t,children:t},t))})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(K,{className:"text-sm font-medium text-red-600",children:"Latitude * (Required)"}),e.jsxs(xe,{value:M.latitude,onValueChange:t=>ee(n=>({...n,latitude:t})),children:[e.jsx(ye,{children:e.jsx(ve,{placeholder:"Select latitude column"})}),e.jsx(_e,{children:r().map(t=>e.jsx(te,{value:t,children:t},t))})]})]}),e.jsxs("div",{children:[e.jsx(K,{className:"text-sm font-medium text-red-600",children:"Longitude * (Required)"}),e.jsxs(xe,{value:M.longitude,onValueChange:t=>ee(n=>({...n,longitude:t})),children:[e.jsx(ye,{children:e.jsx(ve,{placeholder:"Select longitude column"})}),e.jsx(_e,{children:r().map(t=>e.jsx(te,{value:t,children:t},t))})]})]})]}),e.jsxs("div",{children:[e.jsx(K,{className:"text-sm font-medium text-gray-600",children:"Notes (Optional)"}),e.jsxs(xe,{value:M.notes,onValueChange:t=>ee(n=>({...n,notes:t})),children:[e.jsx(ye,{children:e.jsx(ve,{placeholder:"Select notes column (optional)"})}),e.jsxs(_e,{children:[e.jsx(te,{value:"none",children:"None"}),r().map(t=>e.jsx(te,{value:t,children:t},t))]})]})]}),e.jsxs("div",{children:[e.jsx(K,{className:"text-sm font-medium text-gray-600",children:"Submarket (Optional)"}),e.jsxs(xe,{value:M.submarketId,onValueChange:t=>ee(n=>({...n,submarketId:t})),children:[e.jsx(ye,{children:e.jsx(ve,{placeholder:"Select submarket column (optional)"})}),e.jsxs(_e,{children:[e.jsx(te,{value:"none",children:"None"}),r().map(t=>e.jsx(te,{value:t,children:t},t))]})]})]})]}),G&&e.jsxs(tt,{variant:"destructive",children:[e.jsx(rt,{className:"h-4 w-4"}),e.jsx(st,{className:"text-sm",children:G})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(le,{onClick:()=>re(!1),variant:"outline",children:"Back"}),e.jsxs(le,{onClick:Te,className:"flex-1",disabled:!M.name||(we==="single"?!M.coordinates:!M.latitude||!M.longitude),children:["Import ",je.length," Prospects"]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(K,{htmlFor:"csv-file",className:"text-sm font-medium",children:"CSV File"}),e.jsx("input",{ref:ne,id:"csv-file",type:"file",accept:".csv",onChange:qe,className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),p&&e.jsxs("div",{className:"mt-2 flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsx("span",{className:"text-sm text-gray-700",children:p.name}),e.jsx(le,{variant:"ghost",size:"sm",onClick:F,className:"h-6 w-6 p-0",children:e.jsx(Ke,{className:"h-4 w-4"})})]})]}),e.jsxs(tt,{children:[e.jsx(rt,{className:"h-4 w-4"}),e.jsx(st,{className:"text-xs",children:"Upload your CSV file and we'll help you map the columns to prospect data."})]}),G&&e.jsxs(tt,{variant:"destructive",children:[e.jsx(rt,{className:"h-4 w-4"}),e.jsx(st,{className:"text-sm",children:G})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(le,{onClick:Ue,disabled:!p||R,className:"flex-1",children:[R?"Processing...":"Continue",e.jsx(Kt,{className:"ml-2 h-4 w-4"})]}),e.jsx(le,{variant:"outline",onClick:()=>Y(!1),children:"Cancel"})]})]})]})]})}function ss({onApiKeyChange:D}){const[se,Y]=l.useState(!1),[p,Z]=l.useState(!1),G=async()=>{try{Z(!0),await Ne("POST","/api/demo/reset",{}),window.location.reload()}catch{Z(!1)}};return e.jsx(Mt,{children:e.jsxs(ht,{open:se,onOpenChange:Y,children:[e.jsxs(Ge,{children:[e.jsx(Qe,{asChild:!0,children:e.jsx(pt,{asChild:!0,children:e.jsx(le,{variant:"outline",size:"sm",className:"absolute top-4 right-4 z-20 bg-white/90 backdrop-blur-sm border border-gray-200 hover:bg-gray-50",children:e.jsx(ot,{className:"h-4 w-4"})})})}),e.jsx(Ye,{children:e.jsx("p",{children:"Developer Settings"})})]}),e.jsxs(ft,{className:"sm:max-w-md",children:[e.jsx(mt,{children:e.jsxs(gt,{className:"flex items-center gap-2",children:[e.jsx(ot,{className:"h-5 w-5"}),"Developer Settings"]})}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"pt-3",children:[e.jsx(K,{className:"text-sm font-medium",children:"Demo Utilities"}),e.jsx("div",{className:"mt-2 flex gap-2",children:e.jsx(le,{onClick:G,variant:"destructive",disabled:p,children:p?"Resetting…":"Reset Demo Data"})}),e.jsx("p",{className:"mt-2 text-xs text-gray-600",children:"Clears demo prospects, requirements, interactions, and profile."})]})})]})]})})}const rs=["< 5,000 SF","5,000 - 10,000 SF","10,000 - 25,000 SF","25,000 - 50,000 SF","50,000 - 100,000 SF","100,000+ SF"],ns=["drawing","geometry","places"],as={"1_month":"1 Month","3_month":"3 Months","6_month":"6 Months","1_year":"1 Year"},Xe=D=>{if(!D||D.type!=="Polygon")return null;try{let se=D.coordinates;if(Array.isArray(se[0])&&Array.isArray(se[0][0])&&(se=se[0]),!se||se.length<3)return null;const Y=se.map(R=>({lat:R[1],lng:R[0]}));if(window.google?.maps?.geometry?.spherical)return window.google.maps.geometry.spherical.computeArea(Y)*10.764/43560;let p=0;for(let R=0;R<Y.length;R++){const be=(R+1)%Y.length;p+=Y[R].lng*Y[be].lat,p-=Y[be].lng*Y[R].lat}p=Math.abs(p)/2;const Z=111320;return p*Z*Z*10.764/43560}catch{return null}};function Ns(){const{toast:D}=zt(),{user:se}=$t(),{profile:Y}=Gt(),p=l.useMemo(()=>se,[se]),Z=Qt(Y?.submarkets||[]),G={lat:53.5461,lng:-113.4938},H=11,[R,be]=l.useState(null),[y,re]=l.useState(()=>{const s=Oe(ce(p?.id,"mapType"),null);if(s==="roadmap"||s==="hybrid")return s;const c=Oe("mapType::guest",null);return c==="roadmap"||c==="hybrid"?c:"roadmap"}),[je,he]=l.useState(()=>{const s=Oe(ce(p?.id,"mapViewport"),null);return s&&typeof s.lat=="number"&&typeof s.lng=="number"?{lat:s.lat,lng:s.lng}:G}),[M,ee]=l.useState(()=>{const s=Oe(ce(p?.id,"mapViewport"),null);return s&&typeof s.zoom=="number"?s.zoom:H}),[we,Ee]=l.useState(null),ne=l.useRef(null),qe=l.useRef(null),Re=l.useRef(!1),Ue=l.useRef(!1),Te=l.useRef(!1),[de,F]=l.useState("select"),[r,t]=l.useState([]),[n,i]=l.useState([]),[o,v]=l.useState([]),[P,U]=l.useState([]),[B,x]=l.useState(new Set(Object.keys(Je))),[k,g]=l.useState(()=>new Set(Oe(ce(p?.id,"selectedSubmarkets"),[]))),[O,b]=l.useState(()=>Oe(ce(p?.id,"controlPanelOpen"),!1)),[a,d]=l.useState(null),[V,z]=l.useState(!1),[L,ae]=l.useState(null),[E,T]=l.useState(null),$=l.useRef(new Map),[j,W]=l.useState(!1),[I,A]=l.useState(null),N=l.useRef(null),[w,ie]=l.useState(null),C=l.useRef(null);l.useEffect(()=>{C.current=w},[w]);const{isLoaded:q}=jt({id:"google-map-script",googleMapsApiKey:"AIzaSyADyzxiV8GhGgIlNFvCvjs8uOvxkwhjm8k",libraries:ns}),{data:Ce=[],refetch:Fe}=Yt({queryKey:["/api/prospects"],enabled:!!p,retry:!1});l.useEffect(()=>{i(Ce)},[Ce]),l.useEffect(()=>{if(p){const s=Oe(ce(p?.id,"mapData"),null);s&&U(s.touches||[])}},[p?.id]),l.useEffect(()=>{const s=()=>{Ie.invalidateQueries({queryKey:["/api/prospects"]})};return window.addEventListener("userChanged",s),()=>window.removeEventListener("userChanged",s)},[]),l.useCallback(()=>{const s={prospects:n,submarkets:[],touches:P};$e(ce(p?.id,"mapData"),s)},[n,P,p?.id]),l.useEffect(()=>{if(p&&n.length>0){const s={prospects:n,submarkets:[],touches:P};$e(ce(p.id,"mapData"),s)}},[n,P,p?.id]),l.useEffect(()=>{$e(ce(p?.id,"controlPanelOpen"),O)},[O,p?.id]),l.useEffect(()=>{$e(ce(p?.id,"selectedSubmarkets"),Array.from(k))},[k,p?.id]),l.useEffect(()=>{const s=Oe(ce(p?.id,"mapType"),null),c=Oe("mapType::guest",null);re(s==="roadmap"||s==="hybrid"?s:c==="roadmap"||c==="hybrid"?c:"roadmap")},[p?.id]),l.useEffect(()=>{$e(ce(p?.id,"mapType"),y)},[y,p?.id]),l.useEffect(()=>{R&&R.setMapTypeId(y)},[R,y]),l.useEffect(()=>{const s=Oe(ce(p?.id,"mapViewport"),null);s?(he({lat:s.lat,lng:s.lng}),ee(s.zoom??H)):(he(G),ee(H))},[p?.id]);const ue=n.filter(s=>{const c=B.has(s.status),u=k.size===0||s.submarketId&&k.has(s.submarketId);return c&&u}),Le=l.useCallback(s=>{be(s);try{const c=new wt({lib:google.maps,map:s}),u=new Ct({adapter:c,modes:[new St,new kt,new Nt,new _t,new Et,new Pt,new Ot]});u.on("ready",()=>{if(!Te.current)try{const h=s.getDiv();c.getMapEventElement=()=>h,u.stop(),u.start(),u.setMode("select"),Te.current=!0}catch{}}),u.on("finish",async h=>{const f=u.getSnapshotFeature(h),m=u.getSnapshot();t(m);const _=C.current;if(_&&f&&f.geometry&&f.geometry.type==="Polygon")try{const S={type:"Polygon",coordinates:f.geometry.coordinates},X=Xe(S),Se=await(await Ne("PATCH",`/api/prospects/${_.id}`,{geometry:S,acres:X?X.toString():void 0})).json();i(ke=>ke.map(We=>We.id===Se.id?Se:We)),a&&a.id===Se.id&&d(Se),D({title:"Area saved",description:X?`${X.toFixed(2)} acres`:"Polygon saved"})}catch{D({title:"Save failed",description:"Could not save polygon to prospect",variant:"destructive"})}finally{ie(null),Pe("select")}}),u.on("change",()=>{const h=u.getSnapshot();t(h)}),ne.current=u,qe.current=c,F("select"),window.__terra=u}catch{}},[]),J=l.useCallback(()=>{try{ne.current?.stop()}catch{}ne.current=null,qe.current=null,Re.current=!1,Ue.current=!1,Te.current=!1,be(null)},[]),pe=l.useCallback(s=>{N.current=s},[]),Q=l.useCallback(async s=>{let c;if(s.type==="marker"){const h=s.overlay,f=h.getPosition();f&&(c={type:"Point",coordinates:[f.lng(),f.lat()]}),h.setMap(null)}else if(s.type==="polygon"){const h=s.overlay,f=h.getPath(),m=[];for(let _=0;_<f.getLength();_++){const S=f.getAt(_);m.push([S.lng(),S.lat()])}m.length>0&&m.push(m[0]),c={type:"Polygon",coordinates:[m]},h.setMap(null)}else if(s.type==="rectangle"){const h=s.overlay,f=h.getBounds();if(f){const m=f.getNorthEast(),_=f.getSouthWest(),S=new google.maps.LatLng(m.lat(),_.lng()),X=new google.maps.LatLng(_.lat(),m.lng());c={type:"Polygon",coordinates:[[[S.lng(),S.lat()],[m.lng(),m.lat()],[X.lng(),X.lat()],[_.lng(),_.lat()],[S.lng(),S.lat()]]]}}h.setMap(null)}const u=Xe(c);try{if(w&&s.type==="polygon"){const h={geometry:c,acres:u?u.toString():void 0};if(w.id==="temp-prospect"){const f={name:w.name,status:w.status,notes:w.notes,geometry:c,acres:u?u.toString():void 0,submarketId:w.submarketId},_=await(await Ne("POST","/api/prospects",f)).json();i(S=>[...S,_]),d(_)}else{const m=await(await Ne("PATCH",`/api/prospects/${w.id}`,h)).json();i(_=>_.map(S=>S.id===m.id?m:S)),d(m)}Ie.invalidateQueries({queryKey:["/api/prospects"]}),D({title:"Polygon Added",description:`Polygon area added to prospect${u?` (${u.toFixed(2)} acres)`:""}`}),ie(null),z(!0)}else{const h={name:`New ${s.type}`,status:"prospect",notes:"",geometry:c,acres:u?u.toString():void 0},m=await(await Ne("POST","/api/prospects",h)).json();i(_=>[..._,m]),d(m),z(!0),Ie.invalidateQueries({queryKey:["/api/prospects"]}),D({title:"Prospect Saved",description:`New ${s.type} prospect saved to your profile`})}}catch{D({title:"Error",description:"Failed to save prospect. Please try again.",variant:"destructive"})}N.current&&N.current.setDrawingMode(null)},[w,D]),oe=l.useCallback(async s=>{const c=s.filter(f=>!n.some(m=>m.name===f.name||m.geometry.type===f.geometry.type&&JSON.stringify(m.geometry.coordinates)===JSON.stringify(f.geometry.coordinates)));if(c.length===0){D({title:"No New Data",description:"All imported prospects already exist"});return}const u=[];let h=0;for(const f of c)try{const _=await(await Ne("POST","/api/prospects",f)).json();u.push(_),h++}catch{u.push(f)}x(f=>new Set([...Array.from(f),"prospect"])),D({title:"Prospects Imported",description:`${h} prospects saved to your database profile`}),i(f=>[...f,...u]),h>0&&Ie.invalidateQueries({queryKey:["/api/prospects"]})},[n,D]);l.useCallback(()=>{const s=S=>{if(!S)return"";if(S.type==="Point"){const[X,ze]=S.coordinates;return`POINT(${X} ${ze})`}return S.type==="Polygon"?`POLYGON((${(Array.isArray(S.coordinates[0][0])?S.coordinates:[S.coordinates])[0].map(([ke,We])=>`${ke} ${We}`).join(", ")}))`:""},c=ue.map(S=>({name:S.name,status:S.status,notes:S.notes,coordinates:s(S.geometry),submarketId:S.submarketId||"",lastContactDate:S.lastContactDate||"",createdDate:S.createdDate})),u=["name","status","notes","coordinates","submarketId","lastContactDate","createdDate"],h=[u.join(","),...c.map(S=>u.map(X=>`"${S[X]??""}"`).join(","))].join(`
`),f=new Blob([h],{type:"text/csv;charset=utf-8;"}),m=document.createElement("a"),_=URL.createObjectURL(f);m.setAttribute("href",_),m.setAttribute("download",`prospects-${new Date().toISOString().split("T")[0]}.csv`),m.style.visibility="hidden",document.body.appendChild(m),m.click(),document.body.removeChild(m)},[ue]);const fe=l.useCallback(s=>{d(s),z(!0)},[]),Be=l.useCallback(s=>{A({id:"temp-search",lat:s.lat,lng:s.lng,address:s.address,businessName:s.businessName,websiteUrl:s.websiteUrl})},[]),Ve=l.useCallback(s=>"",[]),De=l.useCallback(async()=>{if(I)try{const s={name:I.address,geometry:{type:"Point",coordinates:[I.lng,I.lat]},status:"prospect",notes:"",submarketId:Ve(I)||"",businessName:I.businessName||void 0,contactCompany:I.businessName||void 0,websiteUrl:I.websiteUrl||void 0},u=await(await Ne("POST","/api/prospects",s)).json();i(h=>[...h,u]),d(u),z(!0),Ie.invalidateQueries({queryKey:["/api/prospects"]}),A(null),D({title:"Prospect saved successfully",description:`"${u.name}" has been added to your map.`})}catch{D({title:"Error saving prospect",description:"Failed to save prospect to database.",variant:"destructive"})}},[I,Ve,D,Ie]),me=l.useCallback(()=>{N.current&&(a&&(ie(a),z(!1),D({title:"Draw Mode Enabled",description:`Click on the map to draw an area for ${a.name}.`})),N.current.setDrawingMode(window.google?.maps?.drawing?.OverlayType?.POLYGON))},[a,D]),Pe=l.useCallback(s=>{if(N.current?.setDrawingMode(null),!!ne.current)try{if(ne.current.setMode(s),F(s),R){const c=s!=="select";R.setOptions({draggable:!c,disableDoubleClickZoom:c})}}catch{}},[R]);l.useCallback(()=>{try{ne.current?.clear()}catch{}t([]),Pe("select")},[Pe]);const Ze=l.useCallback(s=>{const c=n.find(h=>h.id===s);if(!c||c.geometry.type!=="Polygon")return;const u=c.geometry.coordinates[0];T(u),ae(s),setTimeout(()=>{const h=$.current.get(s);if(h){h.setEditable(!0),h.setDraggable(!0);const f=h.getPath();let m=null;const _=()=>{m&&clearTimeout(m),m=setTimeout(async()=>{const S=[];for(let Se=0;Se<f.getLength();Se++){const ke=f.getAt(Se);S.push([ke.lng(),ke.lat()])}S.length>0&&S.push(S[0]);const X={type:"Polygon",coordinates:[S]},ze=Xe(X);try{const ke=await(await Ne("PATCH",`/api/prospects/${s}`,{geometry:X,acres:ze?ze.toString():void 0})).json();i(We=>We.map(at=>at.id===ke.id?ke:at)),a&&a.id===ke.id&&d(ke)}catch{}},500)};f.addListener("set_at",_),f.addListener("insert_at",_),f.addListener("remove_at",_)}},100)},[n]),yt=l.useCallback(async()=>{if(!L)return;const s=$.current.get(L);if(!s)return;const c=s.getPath(),u=[];for(let m=0;m<c.getLength();m++){const _=c.getAt(m);u.push([_.lng(),_.lat()])}u.length>2&&u.push(u[0]);const h={type:"Polygon",coordinates:[u]},f=Xe(h);try{const _=await(await Ne("PATCH",`/api/prospects/${L}`,{geometry:h,acres:f?f.toString():void 0})).json();i(S=>S.map(X=>X.id===_.id?_:X)),a&&a.id===_.id&&d(_),s.setEditable(!1),s.setDraggable(!1),ae(null),T(null),D({title:"Polygon Saved",description:`Changes saved successfully${f?` (${f.toFixed(2)} acres)`:""}`})}catch{D({title:"Save Failed",description:"Could not save polygon changes. Please try again.",variant:"destructive",duration:4e3})}},[L,a,D]),vt=l.useCallback(()=>{if(!L||!E)return;const s=$.current.get(L);if(s){const c=s.getPath();c.clear(),E.forEach(([u,h])=>{c.push(new google.maps.LatLng(h,u))}),s.setEditable(!1),s.setDraggable(!1)}ae(null),T(null),D({title:"Changes Discarded",description:"Polygon reverted to original shape"})},[L,E,D]),Me=l.useRef(null),He=l.useRef({}),et=l.useRef(null),nt=l.useCallback(async()=>{if(!a)return;const s=a.id,c=He.current;if(He.current={},!(!c||Object.keys(c).length===0))try{const h=await(await Ne("PATCH",`/api/prospects/${s}`,c)).json();i(f=>f.map(m=>m.id===h.id?h:m)),d(f=>f&&f.id===h.id?h:f),Ie.invalidateQueries({queryKey:["/api/prospects"]})}catch{}},[a,Ie]),ge=l.useCallback((s,c)=>{if(!a)return;const u=a.id;et.current&&et.current!==u&&Me.current&&(window.clearTimeout(Me.current),Me.current=null,He.current={}),et.current=u;const h={...a,[s]:c};d(h),i(f=>f.map(m=>m.id===u?{...m,[s]:c}:m)),He.current={...He.current,[s]:c},Me.current&&window.clearTimeout(Me.current),Me.current=window.setTimeout(()=>{Me.current=null,nt()},450)},[a,nt]),bt=l.useCallback(async()=>{if(a)try{await Ne("DELETE",`/api/prospects/${a.id}`),i(s=>s.filter(c=>c.id!==a.id)),d(null),z(!1),Ie.invalidateQueries({queryKey:["/api/prospects"]}),D({title:"Prospect Deleted",description:"The prospect has been removed from your profile"})}catch{D({title:"Error",description:"Failed to delete prospect from database",variant:"destructive"})}},[a,D]);return l.useCallback(s=>{},[]),q?e.jsxs("div",{style:{position:"relative",height:"calc(100vh - 4rem)",width:"100%",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",inset:0},children:e.jsxs(Tt,{mapContainerStyle:{width:"100%",height:"100%"},center:je,zoom:M,onLoad:Le,onUnmount:J,mapTypeId:y,options:{disableDefaultUI:!0,zoomControl:!0,mapTypeControl:!1,scaleControl:!0,streetViewControl:!1,rotateControl:!1,fullscreenControl:!0,gestureHandling:"greedy"},onIdle:()=>{if(!R)return;const s=R.getCenter(),c=R.getZoom();if(s){const h={lat:s.lat(),lng:s.lng()};$e(ce(p?.id,"mapViewport"),{...h,zoom:c??H})}const u=R.getBounds?.();if(u){const h=u.getNorthEast(),f=u.getSouthWest(),m={north:h.lat(),east:h.lng(),south:f.lat(),west:f.lng()};Ee(_=>_&&_.north===m.north&&_.east===m.east&&_.south===m.south&&_.west===m.west?_:{...m})}if(!Re.current&&ne.current)try{const h=ne.current;h.start(),h.setMode("select");try{h.updateModeOptions("polygon",{styles:{fillColor:"#2563EB",fillOpacity:.2,outlineColor:"#2563EB",outlineWidth:2,closingPointColor:"#2563EB",closingPointOutlineColor:"#ffffff",closingPointOutlineWidth:2,closingPointWidth:6,editedPointColor:"#10B981",editedPointOutlineColor:"#ffffff",editedPointOutlineWidth:2,editedPointWidth:6,coordinatePointColor:"#2563EB",coordinatePointOutlineColor:"#ffffff",coordinatePointOutlineWidth:2,coordinatePointWidth:5,snappingPointColor:"#F59E0B",snappingPointOutlineColor:"#ffffff",snappingPointOutlineWidth:2,snappingPointWidth:6}}),h.updateModeOptions("rectangle",{styles:{fillColor:"#059669",fillOpacity:.2,outlineColor:"#059669",outlineWidth:2}})}catch{}Re.current=!0}catch{}},children:[q&&e.jsx(It,{onLoad:pe,onOverlayComplete:Q,options:{drawingControl:!1,polygonOptions:{fillColor:"#3B82F6",fillOpacity:.15,strokeWeight:2,strokeColor:"#3B82F6",clickable:!0,editable:!1,zIndex:1},markerOptions:{draggable:!1},rectangleOptions:{fillColor:"#059669",fillOpacity:.15,strokeWeight:2,strokeColor:"#059669",clickable:!0,editable:!1,zIndex:1}}}),ue.map(s=>{const c=Je[s.status].color;if(s.geometry.type==="Point"){const[u,h]=s.geometry.coordinates;return e.jsx(it,{position:{lat:h,lng:u},onClick:()=>fe(s),clickable:de==="select",icon:{path:window.google?.maps?.SymbolPath?.CIRCLE,fillColor:c,fillOpacity:1,strokeWeight:2,strokeColor:"#ffffff",scale:8}},s.id)}else if(s.geometry.type==="Polygon"){const u=s.geometry.coordinates;let h;return Array.isArray(u[0])&&Array.isArray(u[0][0])?h=u[0]:h=u,e.jsx(Rt,{paths:h.map(([f,m])=>({lat:m,lng:f})),onClick:()=>fe(s),onLoad:f=>{$.current.set(s.id,f)},options:{fillColor:c,fillOpacity:L===s.id?.25:.15,strokeColor:c,strokeWeight:L===s.id?3:2,strokeOpacity:.8,clickable:!0,editable:L===s.id,draggable:L===s.id,zIndex:L===s.id?2:1}},s.id)}return null}),I&&e.jsxs(e.Fragment,{children:[e.jsx(it,{position:{lat:I.lat,lng:I.lng},icon:{path:window.google?.maps?.SymbolPath?.CIRCLE,fillColor:"#FF6B35",fillOpacity:1,strokeWeight:3,strokeColor:"#ffffff",scale:12}}),e.jsx(Dt,{position:{lat:I.lat,lng:I.lng},onCloseClick:()=>A(null),children:e.jsxs("div",{className:"p-2 max-w-xs",children:[e.jsx("h3",{className:"font-medium text-sm mb-2",children:I.address}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:De,className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white text-xs px-3 py-1.5 rounded transition-colors",children:"Add to Map"}),e.jsx("button",{onClick:()=>A(null),className:"px-2 py-1.5 text-gray-500 hover:text-gray-700 text-xs",children:"✕"})]})]})})]})]})}),e.jsx(Ut,{onSearch:s=>{Be(s),R&&(R.panTo({lat:s.lat,lng:s.lng}),R.setZoom(15)),he({lat:s.lat,lng:s.lng}),ee(15)},bounds:we,defaultCenter:G,onPolygon:()=>{a&&(ie(a),D({title:"Draw Mode",description:`Draw an area for ${a.name}.`})),N.current&&N.current.setDrawingMode(window.google?.maps?.drawing?.OverlayType?.POLYGON)},onPin:()=>{N.current&&N.current.setDrawingMode(window.google?.maps?.drawing?.OverlayType?.MARKER)},onPan:()=>{N.current&&N.current.setDrawingMode(null),D({title:"Pan Tool",description:"Pan/hand tool selected. You can now move the map."})},mapType:y,onMapTypeChange:re,onMyLocation:()=>{R&&(R.panTo(G),R.setZoom(H)),he(G),ee(H),$e(ce(p?.id,"mapViewport"),{...G,zoom:H})},onRectangle:()=>{N.current&&N.current.setDrawingMode(window.google?.maps?.drawing?.OverlayType?.RECTANGLE)},onSelect:()=>Pe("select"),activeTerraMode:de}),e.jsx("div",{className:"absolute bottom-4 right-4",style:{pointerEvents:"auto"},children:e.jsx(ss,{})}),O&&e.jsx("div",{className:"absolute top-0 left-0 h-full w-80 bg-white shadow-xl border-r border-gray-200 z-40",style:{pointerEvents:"auto",transform:"translateX(0)",transition:"transform 0.3s ease-in-out"},children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Filters & Settings"}),e.jsx(le,{variant:"ghost",size:"sm",onClick:()=>b(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(Ke,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Advanced filtering and configuration options will be available here."}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-800 mb-2",children:"Status Filters"}),e.jsx("div",{className:"space-y-2",children:Object.entries(Je).map(([s,c])=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:B.has(s),onChange:()=>{const u=new Set(B);B.has(s)?u.delete(s):u.add(s),x(u)},className:"rounded"}),e.jsx("div",{className:"w-3 h-3 rounded-full border",style:{backgroundColor:c.color}}),e.jsx("span",{className:"text-sm",children:c.label})]},s))})]})]})]})}),V&&a&&e.jsxs("div",{className:"absolute top-0 right-0 w-80 h-auto max-h-[90vh] flex flex-col bg-white shadow-xl border-l border-gray-200 z-50 overflow-y-auto",style:{pointerEvents:"auto"},children:[e.jsx("div",{className:"sticky top-0 z-10 bg-white border-b px-4 pt-3 pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-sm font-semibold text-gray-800",children:"Edit Prospect"}),e.jsxs(Ge,{children:[e.jsx(Qe,{asChild:!0,children:e.jsx(le,{variant:"ghost",size:"sm",onClick:()=>z(!1),className:"text-gray-400 hover:text-gray-600 h-6 w-6 p-0","aria-label":"Save and close",children:e.jsx(Ke,{className:"h-4 w-4"})})}),e.jsx(Ye,{side:"left",children:"Save and close"})]})]})}),e.jsxs("div",{className:"px-4 py-3 space-y-4",children:[e.jsx("p",{className:"text-[11px] text-gray-500",children:"Changes save automatically"}),e.jsxs(Wt,{defaultValue:"property",className:"space-y-4",children:[e.jsxs(Bt,{className:"grid w-full grid-cols-2",children:[e.jsx(lt,{value:"property",className:"text-xs",children:"Property"}),e.jsx(lt,{value:"contact",className:"text-xs",children:"Contact"})]}),e.jsxs(ct,{value:"property",className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(K,{className:"text-xs font-medium text-gray-700",children:"Address"}),e.jsx(Ae,{value:a.name,onChange:s=>ge("name",s.target.value),placeholder:"Property address",className:"h-8 text-sm"})]}),(a.businessName||a.websiteUrl)&&e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(K,{className:"text-xs font-medium text-gray-700",children:"Business Name"}),e.jsx(Ae,{value:a.businessName||"",onChange:s=>ge("businessName",s.target.value||void 0),placeholder:"Business name",className:"h-8 text-sm"})]}),e.jsxs("div",{children:[e.jsx(K,{className:"text-xs font-medium text-gray-700",children:"Website"}),e.jsx(Ae,{type:"url",value:a.websiteUrl||"",onChange:s=>ge("websiteUrl",s.target.value||void 0),placeholder:"Website URL",className:"h-8 text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(K,{className:"text-xs font-medium text-gray-700",children:"Status"}),e.jsxs(xe,{value:a.status,onValueChange:s=>ge("status",s),children:[e.jsx(ye,{className:"h-8 text-sm",children:e.jsx(ve,{})}),e.jsx(_e,{children:Object.entries(Je).map(([s,c])=>e.jsx(te,{value:s,children:e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{backgroundColor:c.color}}),c.label]})},s))})]})]}),e.jsxs("div",{children:[e.jsx(K,{className:"text-xs font-medium text-gray-700",children:"Follow Up"}),e.jsxs(xe,{value:a.followUpTimeframe||"none",onValueChange:s=>ge("followUpTimeframe",s==="none"?void 0:s),children:[e.jsx(ye,{className:"h-8 text-sm",children:e.jsx(ve,{placeholder:"None"})}),e.jsxs(_e,{children:[e.jsx(te,{value:"none",children:"None"}),Object.entries(as).map(([s,c])=>e.jsx(te,{value:s,children:c},s))]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(K,{className:"text-xs font-medium text-gray-700",children:"Size"}),e.jsxs(xe,{value:a.size||"",onValueChange:s=>ge("size",s==="none"?"":s),children:[e.jsx(ye,{className:"h-8 text-sm",children:e.jsx(ve,{placeholder:"Select size"})}),e.jsxs(_e,{children:[e.jsx(te,{value:"none",children:"None"}),rs.map(s=>e.jsx(te,{value:s,children:s},s))]})]})]}),e.jsxs("div",{children:[e.jsx(K,{className:"text-xs font-medium text-gray-700",children:"Acres"}),e.jsx(Ae,{value:a.acres||"",placeholder:"Auto-calculated from polygon",className:"h-8 text-sm bg-gray-50",disabled:!0})]})]}),e.jsxs("div",{children:[e.jsx(K,{className:"text-xs font-medium text-gray-700",children:"Submarket"}),Z.length===0?e.jsx(xe,{disabled:!0,children:e.jsx(ye,{className:"h-8 text-sm",children:e.jsx(ve,{placeholder:"No submarkets defined"})})}):e.jsxs(xe,{value:a.submarketId||"",onValueChange:s=>ge("submarketId",s==="none"?void 0:s),children:[e.jsx(ye,{className:"h-8 text-sm",children:e.jsx(ve,{placeholder:"Select submarket"})}),e.jsxs(_e,{children:[e.jsx(te,{value:"none",children:"None"}),Z.map(s=>e.jsx(te,{value:s,children:s},s))]})]})]}),e.jsxs("div",{children:[e.jsx(K,{className:"text-xs font-medium text-gray-700",children:"Notes"}),e.jsx(qt,{value:a.notes,onChange:s=>ge("notes",s.target.value),placeholder:"Add notes...",rows:3,className:"resize-none text-sm"})]})]}),e.jsxs(ct,{value:"contact",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(K,{className:"text-xs font-medium text-gray-700",children:"Contact Name"}),e.jsx(Ae,{value:a.contactName||"",onChange:s=>ge("contactName",s.target.value),placeholder:"Name",className:"h-8 text-sm"})]}),e.jsxs("div",{children:[e.jsx(K,{className:"text-xs font-medium text-gray-700",children:"Company"}),e.jsx(Ae,{value:a.contactCompany||"",onChange:s=>ge("contactCompany",s.target.value),placeholder:"Company",className:"h-8 text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(K,{className:"text-xs font-medium text-gray-700",children:"Email"}),e.jsx(Ae,{type:"email",value:a.contactEmail||"",onChange:s=>ge("contactEmail",s.target.value),placeholder:"Email",className:"h-8 text-sm"})]}),e.jsxs("div",{children:[e.jsx(K,{className:"text-xs font-medium text-gray-700",children:"Phone"}),e.jsx(Ae,{type:"tel",value:a.contactPhone||"",onChange:s=>ge("contactPhone",s.target.value),placeholder:"Phone",className:"h-8 text-sm"})]})]})]})]})]}),e.jsx("div",{className:"sticky bottom-0 z-10 bg-white border-t px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Ge,{children:[e.jsx(Qe,{asChild:!0,children:e.jsx(le,{onClick:()=>z(!1),variant:"outline",className:"h-8 w-8 p-0 text-xs","aria-label":"Save and close",title:"Save and close",children:e.jsx(dt,{className:"h-3.5 w-3.5"})})}),e.jsx(Ye,{children:"Save and close"})]}),a.geometry.type==="Polygon"?L===a.id?e.jsxs("div",{className:"flex gap-2 flex-1",children:[e.jsxs(le,{onClick:yt,className:"bg-green-600 hover:bg-green-700 flex-1 h-8 text-xs",title:"Save Changes",children:[e.jsx(dt,{className:"h-3.5 w-3.5 mr-1"}),"Save Changes"]}),e.jsxs(le,{onClick:vt,variant:"outline",className:"flex-1 h-8 text-xs hover:bg-red-50 hover:text-red-600 hover:border-red-200",title:"Discard Changes",children:[e.jsx(Ke,{className:"h-3.5 w-3.5 mr-1"}),"Discard"]})]}):e.jsxs(Ge,{children:[e.jsx(Qe,{asChild:!0,children:e.jsx(le,{onClick:()=>Ze(a.id),variant:"outline",className:"h-8 w-8 p-0","aria-label":"Edit shape",title:"Edit shape",children:e.jsx(ut,{className:"h-3.5 w-3.5"})})}),e.jsx(Ye,{children:"Edit shape"})]}):e.jsxs(Ge,{children:[e.jsx(Qe,{asChild:!0,children:e.jsx(le,{onClick:()=>me(),variant:"outline",className:"h-8 w-8 p-0","aria-label":"Draw area",title:"Draw area",children:e.jsx(ut,{className:"h-3.5 w-3.5"})})}),e.jsx(Ye,{children:"Draw area"})]}),e.jsx(le,{onClick:bt,variant:"destructive",className:"h-8 px-3 text-xs",title:"Delete Prospect",children:e.jsx(Zt,{className:"h-3.5 w-3.5"})})]})})]}),j&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Import CSV Data"}),e.jsx(le,{onClick:()=>W(!1),variant:"ghost",size:"sm",className:"p-1",children:e.jsx(Ke,{className:"h-4 w-4"})})]}),e.jsx(ts,{onProspectsImport:s=>{oe(s),W(!1)}})]})}),e.jsx("div",{className:"absolute bottom-4 left-4 z-20",style:{pointerEvents:"auto"},children:e.jsx(Vt,{selected:B,onToggle:s=>{const c=new Set(B);c.has(s)?c.delete(s):c.add(s),x(c)}})})]}):e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading Maps..."})]})})}export{Ns as default};
