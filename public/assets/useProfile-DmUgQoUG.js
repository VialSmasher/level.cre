import{u as m,c}from"./query-BAwt2wOP.js";import{q as t,e as s}from"./index-DIhazG7A.js";function k(){const{data:r,isLoading:n,error:u}=m({queryKey:["/api/profile"],retry:!1}),i=c({mutationFn:async a=>(await s("PATCH","/api/profile",a)).json(),onSuccess:()=>{t.invalidateQueries({queryKey:["/api/profile"]}),t.invalidateQueries({queryKey:["/api/submarkets"]}),window.dispatchEvent(new CustomEvent("submarketChange"))}});return{profile:r,isLoading:n,error:u,hasProfile:!!r,updateSubmarkets:async a=>{t.setQueryData(["/api/profile"],e=>e&&{...e,submarkets:a});try{for(const e of a){const o=await s("GET","/api/submarkets");o.ok&&((await o.json()).some(p=>p.name===e)||await s("POST","/api/submarkets",{name:e,color:`#${Math.floor(Math.random()*16777215).toString(16)}`,isActive:!0}))}t.invalidateQueries({queryKey:["/api/submarkets"]})}catch{}return i.mutate({submarkets:a})},isUpdating:i.isPending}}export{k as u};
