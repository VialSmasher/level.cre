import{u as w,j as e,G as M,t as N,H as S,a as b,w as k,b as T}from"./maps-BkP_85Bm.js";import{r as n}from"./react-BUvn9Qyq.js";import{B as o}from"./index-DIhazG7A.js";import{C as h,b as x,c as m,a as f}from"./card-CVaT3zxn.js";import"./supabase-LVwxr6rx.js";import"./query-BAwt2wOP.js";import"./charts-Ciu5p52_.js";const E={width:"100%",height:"100%"},R={lat:39.8283,lng:-98.5795};function B(){const{isLoaded:j,loadError:u}=w({id:"google-map-script",googleMapsApiKey:"AIzaSyADyzxiV8GhGgIlNFvCvjs8uOvxkwhjm8k"}),c=n.useRef(null),a=n.useRef(null),[i,p]=n.useState("select"),[y,d]=n.useState([]);n.useEffect(()=>()=>{try{a.current?.stop()}catch{}a.current=null,c.current=null},[]);const C=s=>{c.current=s;const r=new N({lib:google.maps,map:s});try{const g=s.getDiv();r.getMapEventElement=()=>g}catch{}const t=new S({adapter:r,modes:[new b,new k,new T]});t.on("finish",()=>d(t.getSnapshot())),t.on("change",()=>d(t.getSnapshot())),t.start(),t.setMode("select"),a.current=t,p("select")},l=s=>{const r=a.current,t=c.current;if(!(!r||!t))try{r.setMode(s),p(s),t.setOptions({draggable:s==="select",disableDoubleClickZoom:s!=="select"})}catch{}},v=()=>{try{a.current?.clear()}catch{}d([]),l("select")};return u?e.jsx("div",{className:"p-4",children:e.jsxs(h,{children:[e.jsx(x,{children:e.jsx(m,{children:"Google Maps failed to load"})}),e.jsx(f,{children:String(u)})]})}):e.jsx("div",{className:"p-4 space-y-3",children:e.jsxs(h,{children:[e.jsx(x,{children:e.jsx(m,{children:"Terra Draw Minimal Test"})}),e.jsxs(f,{className:"space-y-3",children:[e.jsx("div",{className:"w-full",style:{height:480},children:j?e.jsx(M,{onLoad:C,mapContainerStyle:E,center:R,zoom:4,options:{streetViewControl:!1,mapTypeControl:!0,fullscreenControl:!1,gestureHandling:"greedy"}}):e.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:"Loading mapâ€¦"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{variant:i==="select"?"default":"outline",onClick:()=>l("select"),children:"Select"}),e.jsx(o,{variant:i==="polygon"?"default":"outline",onClick:()=>l("polygon"),children:"Polygon"}),e.jsx(o,{variant:i==="rectangle"?"default":"outline",onClick:()=>l("rectangle"),children:"Rectangle"}),e.jsx("div",{className:"ml-auto flex gap-2",children:e.jsx(o,{variant:"outline",onClick:v,children:"Clear"})})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Features: ",y.length]})]})]})})}export{B as default};
