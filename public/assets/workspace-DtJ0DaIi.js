import{j as e,u as Ue,G as Ge,D as Ve,M as ge,P as Ze}from"./maps-BkP_85Bm.js";import{r as o}from"./react-BUvn9Qyq.js";import{c as He,f as Ae,u as Te,e as P,B as C,y as Je,r as Ye,a as U,b as G,d as V,X as Ce}from"./index-DIhazG7A.js";import{b as De,u as se,c as ie}from"./query-BAwt2wOP.js";import{B as Xe}from"./badge-BzWFgtZE.js";import{S as Q,a as q,b as z,c as Z,d as E}from"./select-DtWl5TGT.js";import{L as j,I as L}from"./label-1jjjNnWq.js";import{T as es}from"./textarea-D0vZhPYN.js";import{S as xe,M as ss,e as ts,T as as,a as rs,b as Se,c as ke,d as Pe,P as Ee}from"./StatusLegend-BMpzq6H0.js";import{u as ns}from"./useProfile-DmUgQoUG.js";import{u as is}from"./submarkets-DYRPNR7X.js";import{D as os,b as ls,c as cs,d as ds}from"./dialog-BERENffF.js";import{T as Le}from"./trash-2-Cz6C_y_-.js";import{S as us}from"./share-2-B3qhJonk.js";import"./supabase-LVwxr6rx.js";import"./charts-Ciu5p52_.js";import"./index-NSkCLJ8O.js";import"./map-pin-C6sM-pao.js";const ms=He("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);function ps({listingId:v,open:r,onOpenChange:oe,canManage:M}){const m=De(),{isDemoMode:_}=Ae(),{toast:S}=Te(),{data:K=[]}=se({queryKey:["/api/listings",v,"members"],enabled:r&&!!v}),[I,le]=o.useState(""),[te,W]=o.useState("viewer"),$=ie({mutationFn:async()=>(await P("POST",`/api/listings/${v}/members`,{email:I.trim(),role:te})).json(),onSuccess:n=>{m.setQueryData(["/api/listings",v,"members"],p=>{const g=Array.isArray(p)?[...p]:[],w=g.findIndex(b=>b.userId===n.userId);return w===-1?g.push(n):g[w]=n,g}),le(""),W("viewer"),S({title:"Invite sent",description:n.email||n.userId})},onError:async n=>{const p=n?.message||"Failed to invite";S({title:"Invite failed",description:p,variant:"destructive"})}}),y=ie({mutationFn:async({userId:n,role:p})=>{if(!(await P("PATCH",`/api/listings/${v}/members/${n}`,{role:p})).ok)throw new Error("Failed");return{userId:n,role:p}},onMutate:async({userId:n,role:p})=>{const g=["/api/listings",v,"members"],w=m.getQueryData(g)||[];return m.setQueryData(g,w.map(b=>b.userId===n?{...b,role:p}:b)),{prev:w}},onError:(n,p,g)=>{g?.prev&&m.setQueryData(["/api/listings",v,"members"],g.prev)},onSettled:()=>{m.invalidateQueries({queryKey:["/api/listings",v,"members"]})}}),ce=ie({mutationFn:async n=>{if(!(await P("DELETE",`/api/listings/${v}/members/${n}`)).ok)throw new Error("Failed");return n},onMutate:async n=>{const p=["/api/listings",v,"members"],g=m.getQueryData(p)||[];return m.setQueryData(p,g.filter(w=>w.userId!==n)),{prev:g}},onError:(n,p,g)=>{g?.prev&&m.setQueryData(["/api/listings",v,"members"],g.prev)},onSettled:()=>{m.invalidateQueries({queryKey:["/api/listings",v,"members"]})}});return e.jsx(os,{open:r,onOpenChange:oe,children:e.jsxs(ls,{className:"max-w-lg",children:[e.jsx(cs,{children:e.jsx(ds,{children:"Share Workspace"})}),e.jsxs("div",{className:"space-y-4",children:[_&&e.jsx("div",{className:"text-sm p-2 rounded border bg-amber-50 text-amber-900 border-amber-200",children:"Demo mode: sharing is local-only and does not carry over to Google sign-in. Invites are disabled."}),e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(j,{children:"Email"}),e.jsx(L,{value:I,onChange:n=>le(n.target.value),onKeyDown:n=>{n.key==="Enter"&&I.trim()&&!$.isPending&&$.mutate()},placeholder:"name@example.com"})]}),e.jsxs("div",{children:[e.jsx(j,{children:"Role"}),e.jsxs(Q,{value:te,onValueChange:n=>W(n),children:[e.jsx(q,{className:"w-[140px]",children:e.jsx(z,{})}),e.jsxs(Z,{children:[e.jsx(E,{value:"viewer",children:"Viewer"}),e.jsx(E,{value:"editor",children:"Editor"})]})]})]}),e.jsx(C,{type:"button",onClick:()=>$.mutate(),disabled:!I.trim()||$.isPending,title:_?"Demo mode: invites disabled (server will reject)":void 0,children:"Invite"})]}),e.jsxs("div",{className:"border rounded",children:[e.jsxs("div",{className:"grid grid-cols-[1fr_auto_auto] gap-2 px-3 py-2 text-xs font-medium text-gray-500 border-b",children:[e.jsx("div",{children:"Member"}),e.jsx("div",{children:"Role"}),e.jsx("div",{})]}),e.jsx("div",{className:"max-h-72 overflow-auto",children:K.map(n=>e.jsxs("div",{className:"grid grid-cols-[1fr_auto_auto] items-center gap-2 px-3 py-2 border-b last:border-b-0",children:[e.jsxs("div",{className:"text-sm",children:[n.email||n.userId,n.role==="owner"&&e.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"(Owner)"})]}),e.jsx("div",{children:n.role==="owner"?e.jsx("span",{className:"text-xs",children:"owner"}):e.jsxs(Q,{value:n.role,onValueChange:p=>y.mutate({userId:n.userId,role:p}),disabled:!M,children:[e.jsx(q,{className:"w-[120px]",children:e.jsx(z,{})}),e.jsxs(Z,{children:[e.jsx(E,{value:"viewer",children:"viewer"}),e.jsx(E,{value:"editor",children:"editor"})]})]})}),e.jsx("div",{className:"flex items-center justify-end",children:n.role!=="owner"&&M&&e.jsx(C,{variant:"ghost",size:"icon",onClick:()=>ce.mutate(n.userId),"aria-label":"Remove",children:e.jsx(Le,{className:"h-4 w-4"})})})]},n.userId))})]})]})]})})}const hs=["drawing","geometry","places"];function Os(){const[,v]=Je("/app/workspaces/:id"),r=v?.id,[,oe]=Ye(),{toast:M}=Te(),m=De(),{user:_}=Ae(),{data:S}=se({queryKey:["/api/listings",r],enabled:!!r}),{data:K=[],refetch:I}=se({queryKey:["/api/listings",r,"prospects"],enabled:!!r}),{data:le=[]}=se({queryKey:["/api/prospects"]}),{data:te=[]}=se({queryKey:["/api/listings",r,"members"],enabled:!!r}),W=!!(S&&_&&S.userId===_.id),$=W?"owner":te.find(s=>s.userId===_?.id)?.role||null,y={edit:W||$==="editor",share:W},[ce,n]=o.useState(!1);o.useEffect(()=>{if(r)try{localStorage.setItem("lastWorkspaceId",r),localStorage.setItem("lastWorkspacesLocation",`/app/workspaces/${r}`),localStorage.setItem("lastListingsLocation",`/app/listings/${r}`)}catch{}},[r]),o.useEffect(()=>{r&&P("GET",`/api/listings/${r}/prospects`).then(s=>s.json()).then(()=>{m.invalidateQueries({queryKey:["/api/listings",r,"prospects"]})}).catch(()=>{})},[r]);const{isLoaded:p}=Ue({id:"google-map-script",googleMapsApiKey:"AIzaSyADyzxiV8GhGgIlNFvCvjs8uOvxkwhjm8k",libraries:hs}),[g,w]=o.useState("select"),b=o.useRef(null),de={lat:53.5461,lng:-113.4938},F=o.useMemo(()=>{if(!S)return null;const s=S.lat??"",t=S.lng??"";if(typeof s!="string"||typeof t!="string"||s.trim()===""||t.trim()==="")return null;const a=Number(s),i=Number(t);return!Number.isFinite(a)||!Number.isFinite(i)?null:{lat:a,lng:i}},[S]),[h,Oe]=o.useState(null),Me=o.useCallback(s=>{Oe(s)},[]);o.useEffect(()=>{if(!h||!p)return;const s=F||de;try{h.setCenter(s),h.setZoom(F?15:11),window.google?.maps?.event?.trigger(h,"resize")}catch{}},[h,p,F]);const[f,ye]=o.useState(null),[fe,Ie]=o.useState("roadmap"),[Fe,Re]=o.useState(null),[d,O]=o.useState(null),[je,R]=o.useState(!1),[ae,ue]=o.useState(null),re=o.useRef(new Map),[me,ve]=o.useState(null);o.useEffect(()=>{if(f&&h)try{h.panTo({lat:f.lat,lng:f.lng}),h.setZoom(17)}catch{}},[f,h]);const[B,we]=o.useState(()=>new Set(Object.keys(xe))),Qe=o.useMemo(()=>K.filter(s=>B.has(s.status)),[K,B]);o.useEffect(()=>{if(r)try{const s=localStorage.getItem(`workspaceStatusFilters:${r}`);if(s){const t=JSON.parse(s);Array.isArray(t)&&t.length>0&&we(new Set(t))}}catch{}},[r]),o.useEffect(()=>{if(r)try{localStorage.setItem(`workspaceStatusFilters:${r}`,JSON.stringify(Array.from(B)))}catch{}},[B,r]);const{profile:qe}=ns(),be=is(qe?.submarkets||[]),ze={"1_month":"1 Month","3_month":"3 Months","6_month":"6 Months","1_year":"1 Year"},_e=s=>{if(!s||s.type!=="Polygon")return null;try{let t=s.coordinates;if(Array.isArray(t[0])&&Array.isArray(t[0][0])&&(t=t[0]),!t||t.length<3)return null;const a=t.map(c=>({lat:c[1],lng:c[0]}));if(window.google?.maps?.geometry?.spherical)return window.google.maps.geometry.spherical.computeArea(a)*10.764/43560;let i=0;for(let c=0;c<a.length;c++){const x=(c+1)%a.length;i+=a[c].lng*a[x].lat,i-=a[x].lng*a[c].lat}i=Math.abs(i)/2;const u=111320;return i*u*u*10.764/43560}catch{return null}},A=o.useRef(null),H=o.useRef({}),ne=o.useRef(null),J=o.useCallback(async()=>{if(!y.edit)return;const s=ne.current||d?.id||null;if(!s)return;const t=H.current;if(H.current={},!(!t||Object.keys(t).length===0))try{const i=await(await P("PATCH",`/api/prospects/${s}`,t)).json();O(u=>u&&u.id===i.id?i:u),m.setQueryData(["/api/listings",r,"prospects"],u=>Array.isArray(u)?u.map(l=>l.id===i.id?i:l):u),m.setQueryData(["/api/prospects"],u=>Array.isArray(u)?u.map(l=>l.id===i.id?i:l):u)}catch{}},[m,r,d,y.edit]),Ne=o.useCallback((s,t,a)=>{if(!y.edit||!d)return;const i=d.id;ne.current&&ne.current!==i&&A.current&&(window.clearTimeout(A.current),A.current=null,H.current={}),ne.current=i;const u={...d,[s]:t};O(u),m.setQueryData(["/api/listings",r,"prospects"],l=>Array.isArray(l)?l.map(c=>c.id===i?{...c,[s]:t}:c):l),m.setQueryData(["/api/prospects"],l=>Array.isArray(l)?l.map(c=>c.id===i?{...c,[s]:t}:c):l),H.current={...H.current,[s]:t},a?.flush?(A.current&&(window.clearTimeout(A.current),A.current=null),J()):(A.current&&window.clearTimeout(A.current),A.current=window.setTimeout(()=>{A.current=null,J()},450))},[r,m,J,d,y.edit]),N=o.useCallback((s,t)=>{Ne(s,t)},[Ne]),Ke=o.useCallback(async()=>{if(y.edit&&d)try{await P("DELETE",`/api/prospects/${d.id}`),O(null),R(!1),m.invalidateQueries({queryKey:["/api/prospects"]}),m.invalidateQueries({queryKey:["/api/listings",r,"prospects"]}),M({title:"Prospect Deleted"})}catch{}},[d,r,y.edit]),We=o.useCallback(s=>{if(!y.edit)return;const t=K.find(i=>i.id===s);if(!t||t.geometry.type!=="Polygon")return;const a=t.geometry.coordinates[0];ve(a),ue(s),setTimeout(()=>{const i=re.current.get(s);if(i){i.setEditable(!0),i.setDraggable(!0);const u=i.getPath();let l=null;const c=()=>{l&&clearTimeout(l),l=setTimeout(async()=>{const x=[];for(let X=0;X<u.getLength();X++){const D=u.getAt(X);x.push([D.lng(),D.lat()])}x.length>0&&x.push(x[0]);const T={type:"Polygon",coordinates:[x]},Y=_e(T);try{const D=await(await P("PATCH",`/api/prospects/${s}`,{geometry:T,acres:Y?Y.toString():void 0})).json();O(k=>k&&k.id===D.id?D:k),m.setQueryData(["/api/listings",r,"prospects"],k=>Array.isArray(k)?k.map(ee=>ee.id===D.id?D:ee):k),m.setQueryData(["/api/prospects"],k=>Array.isArray(k)?k.map(ee=>ee.id===D.id?D:ee):k)}catch{}},500)};u.addListener("set_at",c),u.addListener("insert_at",c),u.addListener("remove_at",c)}},100)},[K,r,y.edit]),$e=o.useCallback(()=>{ue(null);const s=d?re.current.get(d.id):null;s&&(s.setEditable(!1),s.setDraggable(!1))},[d]),Be=o.useCallback(()=>{if(!ae||!me)return;const s=re.current.get(ae);if(s){const t=s.getPath();t.clear(),me.forEach(([a,i])=>t.push(new google.maps.LatLng(i,a))),s.setEditable(!1),s.setDraggable(!1)}ue(null),ve(null)},[ae,me]),pe=ie({mutationFn:async()=>{if(!f)throw new Error("No selection");const s={name:f.address,geometry:{type:"Point",coordinates:[f.lng,f.lat]},status:"prospect",notes:"",businessName:f.businessName||void 0,websiteUrl:f.websiteUrl||void 0,contactCompany:f.businessName||void 0},a=await(await P("POST","/api/prospects",s)).json();return await P("POST",`/api/listings/${r}/prospects`,{prospectId:a.id}),a},onSuccess:s=>{m.setQueryData(["/api/listings",r,"prospects"],t=>Array.isArray(t)?[...t,s]:[s]),m.invalidateQueries({queryKey:["/api/listings",r,"prospects"]}),I(),ye(null),O(s),R(!0),M({title:"Prospect added",description:`${s.name} linked to workspace`})}}),he="AIzaSyADyzxiV8GhGgIlNFvCvjs8uOvxkwhjm8k";return e.jsxs("div",{className:"flex-1 min-h-0 flex flex-col",children:[e.jsxs("div",{className:"relative flex-1 min-h-0 w-full overflow-hidden",children:[!he,!p&&he&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500",children:"Loading map..."}),p&&he&&e.jsxs("div",{style:{position:"absolute",inset:0},children:[e.jsxs("div",{className:"absolute top-4 z-[1000] pointer-events-auto flex items-center gap-2",style:{right:je?352:16},children:[e.jsxs(U,{children:[e.jsx(G,{asChild:!0,children:e.jsx(C,{variant:"secondary",size:"icon",className:"h-8 w-8 shadow",onClick:()=>oe("/app/workspaces"),"aria-label":"Exit workspace",title:"Exit workspace",children:e.jsx(ms,{className:"h-4 w-4"})})}),e.jsx(V,{children:e.jsx("p",{children:"Exit workspace"})})]}),e.jsx(Xe,{variant:"secondary",className:"shadow",children:S?.title||S?.address}),e.jsxs(U,{children:[e.jsx(G,{asChild:!0,children:e.jsxs(C,{variant:"secondary",size:"sm",className:"h-8 shadow",onClick:()=>n(!0),children:[e.jsx(us,{className:"h-4 w-4 mr-1"})," Share"]})}),e.jsx(V,{children:e.jsx("p",{children:"Share workspace"})})]})]}),e.jsxs(Ge,{onLoad:Me,mapContainerStyle:{width:"100%",height:"100%"},defaultCenter:F||de,defaultZoom:F?15:11,options:{disableDefaultUI:!0,zoomControl:!0,mapTypeControl:!1,scaleControl:!0,streetViewControl:!1,rotateControl:!1,fullscreenControl:!1,gestureHandling:"greedy",mapTypeId:fe},onIdle:()=>{if(!h)return;const s=h.getBounds?.();if(s){const t=s.getNorthEast(),a=s.getSouthWest();Re({north:t.lat(),east:t.lng(),south:a.lat(),west:a.lng()})}},children:[e.jsx(Ve,{onLoad:s=>{b.current=s},onOverlayComplete:async s=>{try{const t=s.type?.toString().toLowerCase();let a=null;if(t==="marker"&&s.overlay?.getPosition){const l=s.overlay.getPosition();a={type:"Point",coordinates:[l.lng(),l.lat()]}}else if(t==="polygon"&&s.overlay?.getPath){const l=s.overlay.getPath(),c=[];for(let x=0;x<l.getLength();x++){const T=l.getAt(x);c.push([T.lng(),T.lat()])}c.length>0&&c.push(c[0]),a={type:"Polygon",coordinates:[c]}}else if(t==="rectangle"&&s.overlay?.getBounds){const l=s.overlay.getBounds(),c=l.getNorthEast(),x=l.getSouthWest(),T=new google.maps.LatLng(c.lat(),x.lng()),Y=new google.maps.LatLng(x.lat(),c.lng());a={type:"Polygon",coordinates:[[[T.lng(),T.lat()],[c.lng(),c.lat()],[Y.lng(),Y.lat()],[x.lng(),x.lat()],[T.lng(),T.lat()]]]}}try{s.overlay?.setMap(null)}catch{}if(!a)return;const u=await(await P("POST","/api/prospects",{name:"New Prospect",status:"prospect",notes:"",geometry:a})).json();await P("POST",`/api/listings/${r}/prospects`,{prospectId:u.id}),m.setQueryData(["/api/listings",r,"prospects"],l=>Array.isArray(l)?[...l,u]:[u]),m.invalidateQueries({queryKey:["/api/listings",r,"prospects"],refetchType:"active"}),I(),M({title:"Prospect created",description:"Linked to workspace"}),b.current?.setDrawingMode(null),w("select"),h?.setOptions({draggable:!0,disableDoubleClickZoom:!1}),O(u),R(!0)}catch{M({title:"Error",description:"Failed to save prospect",variant:"destructive"})}},options:{drawingControl:!1,markerOptions:{draggable:!1},polygonOptions:{fillColor:"#3B82F6",fillOpacity:.15,strokeColor:"#3B82F6",strokeWeight:2},rectangleOptions:{fillColor:"#059669",fillOpacity:.15,strokeColor:"#059669",strokeWeight:2}}}),F&&e.jsx(ge,{position:F,icon:{path:window.google?.maps?.SymbolPath?.CIRCLE,fillColor:"#ef4444",fillOpacity:1,strokeWeight:2,strokeColor:"#ffffff",scale:10}}),f&&e.jsx(ge,{position:{lat:f.lat,lng:f.lng},icon:{path:window.google?.maps?.SymbolPath?.CIRCLE,fillColor:"#7C3AED",fillOpacity:1,strokeWeight:2,strokeColor:"#ffffff",scale:8},title:f.address}),Qe.map(s=>{const t=xe[s.status]?.color||"#3B82F6";if(s.geometry.type==="Point"){const[a,i]=s.geometry.coordinates;return e.jsx(ge,{position:{lat:i,lng:a},onClick:()=>{O(s),R(!0)},icon:{path:window.google?.maps?.SymbolPath?.CIRCLE,fillColor:t,fillOpacity:1,strokeWeight:2,strokeColor:"#ffffff",scale:8}},s.id)}else if(s.geometry.type==="Polygon"){const a=s.geometry.coordinates,i=Array.isArray(a[0])&&Array.isArray(a[0][0])?a[0]:a;return e.jsx(Ze,{paths:i.map(([u,l])=>({lat:l,lng:u})),onClick:()=>{O(s),R(!0)},onLoad:u=>{re.current.set(s.id,u)},options:{fillColor:t,fillOpacity:.15,strokeColor:t,strokeOpacity:.8,strokeWeight:2}},s.id)}return null}),e.jsx(ss,{onSearch:s=>ye(s),bounds:Fe,defaultCenter:de,onPolygon:()=>{try{b.current?.setDrawingMode(window.google.maps.drawing.OverlayType.POLYGON),w("polygon"),h?.setOptions({draggable:!1,disableDoubleClickZoom:!0})}catch{}},onRectangle:()=>{try{b.current?.setDrawingMode(window.google.maps.drawing.OverlayType.RECTANGLE),w("rectangle"),h?.setOptions({draggable:!1,disableDoubleClickZoom:!0})}catch{}},onPin:()=>{try{b.current?.setDrawingMode(window.google.maps.drawing.OverlayType.MARKER),w("point"),h?.setOptions({draggable:!1,disableDoubleClickZoom:!0})}catch{}},onSelect:()=>{try{b.current?.setDrawingMode(null),w("select"),h?.setOptions({draggable:!0,disableDoubleClickZoom:!1})}catch{}},onPan:()=>{try{b.current?.setDrawingMode(null),w("select"),h?.setOptions({draggable:!0,disableDoubleClickZoom:!1})}catch{}},onMyLocation:()=>{!h||!navigator.geolocation||navigator.geolocation.getCurrentPosition(s=>{const t={lat:s.coords.latitude,lng:s.coords.longitude};h.setCenter(t),h.setZoom(15)})},mapType:fe,onMapTypeChange:s=>{Ie(s);try{h?.setMapTypeId(s)}catch{}},activeTerraMode:g}),f&&e.jsx("div",{style:{position:"absolute",top:76,left:16,zIndex:50},children:e.jsxs("div",{className:"bg-white p-2 rounded shadow border",children:[e.jsx("div",{className:"text-sm mb-2",children:f.address}),e.jsx(C,{size:"sm",onClick:()=>pe.mutate(),disabled:pe.isPending||!y.edit,children:pe.isPending?"Adding...":"Add as Prospect"})]})})]})]})]}),e.jsx("div",{className:"absolute bottom-4 left-4 z-20",style:{pointerEvents:"auto"},children:e.jsx(ts,{selected:B,onToggle:s=>{const t=s,a=new Set(B);a.has(t)?a.delete(t):a.add(t),we(a)}})}),je&&d&&e.jsxs("div",{className:"absolute top-0 right-0 w-80 max-h-[90vh] flex flex-col bg-white shadow-xl border-l border-gray-200 z-50 overflow-y-auto",style:{pointerEvents:"auto"},children:[e.jsx("div",{className:"sticky top-0 z-10 bg-white border-b px-4 pt-3 pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-sm font-semibold text-gray-800",children:"Edit Prospect"}),e.jsxs(U,{children:[e.jsx(G,{asChild:!0,children:e.jsx(C,{variant:"ghost",size:"sm",onClick:()=>{J(),R(!1)},className:"text-gray-400 hover:text-gray-600 h-6 w-6 p-0","aria-label":"Save and close",children:e.jsx(Ce,{className:"h-4 w-4"})})}),e.jsx(V,{side:"left",children:"Save and close"})]})]})}),e.jsxs("div",{className:"px-4 py-3 space-y-4",children:[e.jsx("p",{className:"text-[11px] text-gray-500",children:"Changes save automatically"}),e.jsxs(as,{defaultValue:"property",className:"space-y-4",children:[e.jsxs(rs,{className:"grid w-full grid-cols-2",children:[e.jsx(Se,{value:"property",className:"text-xs",children:"Property"}),e.jsx(Se,{value:"contact",className:"text-xs",children:"Contact"})]}),e.jsxs(ke,{value:"property",className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(j,{className:"text-xs font-medium text-gray-700",children:"Address"}),e.jsx(L,{value:d.name,onChange:s=>N("name",s.target.value),placeholder:"Property address",className:"h-8 text-sm"})]}),(d.businessName||d.websiteUrl)&&e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(j,{className:"text-xs font-medium text-gray-700",children:"Business Name"}),e.jsx(L,{value:d.businessName||"",onChange:s=>N("businessName",s.target.value||void 0),placeholder:"Business name",className:"h-8 text-sm"})]}),e.jsxs("div",{children:[e.jsx(j,{className:"text-xs font-medium text-gray-700",children:"Website"}),e.jsx(L,{type:"url",value:d.websiteUrl||"",onChange:s=>N("websiteUrl",s.target.value||void 0),placeholder:"Website URL",className:"h-8 text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(j,{className:"text-xs font-medium text-gray-700",children:"Status"}),e.jsxs(Q,{value:d.status,onValueChange:s=>N("status",s),children:[e.jsx(q,{className:"h-8 text-sm",children:e.jsx(z,{})}),e.jsx(Z,{children:Object.entries(xe).map(([s,t])=>e.jsx(E,{value:s,children:e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{backgroundColor:t.color}}),t.label]})},s))})]})]}),e.jsxs("div",{children:[e.jsx(j,{className:"text-xs font-medium text-gray-700",children:"Follow Up"}),e.jsxs(Q,{value:d.followUpTimeframe||"none",onValueChange:s=>N("followUpTimeframe",s==="none"?void 0:s),children:[e.jsx(q,{className:"h-8 text-sm",children:e.jsx(z,{placeholder:"None"})}),e.jsxs(Z,{children:[e.jsx(E,{value:"none",children:"None"}),Object.entries(ze).map(([s,t])=>e.jsx(E,{value:s,children:t},s))]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(j,{className:"text-xs font-medium text-gray-700",children:"Size"}),e.jsxs(Q,{value:d.size||"",onValueChange:s=>N("size",s==="none"?"":s),children:[e.jsx(q,{className:"h-8 text-sm",children:e.jsx(z,{placeholder:"Select size"})}),e.jsxs(Z,{children:[e.jsx(E,{value:"none",children:"None"}),["< 5,000 SF","5,000 - 10,000 SF","10,000 - 25,000 SF","25,000 - 50,000 SF","50,000 - 100,000 SF","100,000+ SF"].map(s=>e.jsx(E,{value:s,children:s},s))]})]})]}),e.jsxs("div",{children:[e.jsx(j,{className:"text-xs font-medium text-gray-700",children:"Acres"}),e.jsx(L,{value:d.acres||"",placeholder:"Auto-calculated",className:"h-8 text-sm bg-gray-50",disabled:!0})]})]}),e.jsxs("div",{children:[e.jsx(j,{className:"text-xs font-medium text-gray-700",children:"Submarket"}),be.length===0?e.jsx(Q,{disabled:!0,children:e.jsx(q,{className:"h-8 text-sm",children:e.jsx(z,{placeholder:"No submarkets"})})}):e.jsxs(Q,{value:d.submarketId||"",onValueChange:s=>N("submarketId",s==="none"?void 0:s),children:[e.jsx(q,{className:"h-8 text-sm",children:e.jsx(z,{placeholder:"Select submarket"})}),e.jsxs(Z,{children:[e.jsx(E,{value:"none",children:"None"}),be.map(s=>e.jsx(E,{value:s,children:s},s))]})]})]}),e.jsxs("div",{children:[e.jsx(j,{className:"text-xs font-medium text-gray-700",children:"Notes"}),e.jsx(es,{value:d.notes,onChange:s=>N("notes",s.target.value),rows:3,className:"resize-none text-sm"})]})]}),e.jsxs(ke,{value:"contact",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(j,{className:"text-xs font-medium text-gray-700",children:"Contact Name"}),e.jsx(L,{value:d.contactName||"",onChange:s=>N("contactName",s.target.value||void 0),placeholder:"Contact name",className:"h-8 text-sm"})]}),e.jsxs("div",{children:[e.jsx(j,{className:"text-xs font-medium text-gray-700",children:"Company"}),e.jsx(L,{value:d.contactCompany||"",onChange:s=>N("contactCompany",s.target.value||void 0),placeholder:"Company",className:"h-8 text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(j,{className:"text-xs font-medium text-gray-700",children:"Email"}),e.jsx(L,{type:"email",value:d.contactEmail||"",onChange:s=>N("contactEmail",s.target.value||void 0),placeholder:"name@company.com",className:"h-8 text-sm"})]}),e.jsxs("div",{children:[e.jsx(j,{className:"text-xs font-medium text-gray-700",children:"Phone"}),e.jsx(L,{value:d.contactPhone||"",onChange:s=>N("contactPhone",s.target.value||void 0),placeholder:"(000) 000-0000",className:"h-8 text-sm"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-1",children:[e.jsxs(U,{children:[e.jsx(G,{asChild:!0,children:e.jsx(C,{onClick:()=>{J(),R(!1)},variant:"outline",className:"h-8 w-8 p-0 text-xs","aria-label":"Save and close",children:e.jsx(Pe,{className:"h-3.5 w-3.5"})})}),e.jsx(V,{children:"Save and close"})]}),d.geometry.type==="Polygon"?ae===d.id?e.jsxs("div",{className:"flex gap-2 flex-1",children:[e.jsxs(C,{onClick:$e,className:"bg-green-600 hover:bg-green-700 flex-1 h-8 text-xs",disabled:!y.edit,children:[e.jsx(Pe,{className:"h-3.5 w-3.5 mr-1"}),"Save Changes"]}),e.jsxs(C,{onClick:Be,variant:"outline",className:"flex-1 h-8 text-xs hover:bg-red-50 hover:text-red-600 hover:border-red-200",disabled:!y.edit,children:[e.jsx(Ce,{className:"h-3.5 w-3.5 mr-1"}),"Discard"]})]}):e.jsxs(U,{children:[e.jsx(G,{asChild:!0,children:e.jsx(C,{onClick:()=>We(d.id),variant:"outline",className:"h-8 w-8 p-0",disabled:!y.edit,"aria-label":"Edit shape",children:e.jsx(Ee,{className:"h-3.5 w-3.5"})})}),e.jsx(V,{children:"Edit shape"})]}):e.jsxs(U,{children:[e.jsx(G,{asChild:!0,children:e.jsx(C,{onClick:()=>{b.current?.setDrawingMode(window.google.maps.drawing.OverlayType.POLYGON)},variant:"outline",className:"h-8 w-8 p-0",disabled:!y.edit,"aria-label":"Draw area",children:e.jsx(Ee,{className:"h-3.5 w-3.5"})})}),e.jsx(V,{children:"Draw area"})]}),e.jsx(C,{onClick:Ke,variant:"destructive",className:"h-8 px-3 text-xs",disabled:!y.edit,children:e.jsx(Le,{className:"h-3.5 w-3.5"})})]})]})]}),e.jsx(ps,{listingId:r,open:ce,onOpenChange:n,canManage:y.share})]})}export{Os as default};
